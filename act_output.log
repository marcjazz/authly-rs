time="2026-01-25T15:18:22+01:00" level=info msg="Using docker host 'unix:///var/run/docker.sock', and daemon socket 'unix:///var/run/docker.sock'"
[CI/fmt ] ‚≠ê Run Set up job
[CI/fmt ] üöÄ  Start image=catthehacker/ubuntu:act-latest
[CI/test] ‚≠ê Run Set up job
[CI/lint] ‚≠ê Run Set up job
[CI/lint] üöÄ  Start image=catthehacker/ubuntu:act-latest
[CI/test] üöÄ  Start image=catthehacker/ubuntu:act-latest
[CI/fmt ]   üê≥  docker pull image=catthehacker/ubuntu:act-latest platform= username= forcePull=true
[CI/test]   üê≥  docker pull image=catthehacker/ubuntu:act-latest platform= username= forcePull=true
[CI/lint]   üê≥  docker pull image=catthehacker/ubuntu:act-latest platform= username= forcePull=true
[CI/test] using DockerAuthConfig authentication for docker pull
[CI/fmt ] using DockerAuthConfig authentication for docker pull
[CI/lint] using DockerAuthConfig authentication for docker pull
[CI/fmt ] pulling image 'docker.io/catthehacker/ubuntu:act-latest' () failed with credentials Error response from daemon: Head "https://registry-1.docker.io/v2/catthehacker/ubuntu/manifests/act-latest": unauthorized: incorrect username or password retrying without them, please check for stale docker config files
[CI/test]   üê≥  docker create image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[] network="host"
[CI/lint]   üê≥  docker create image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[] network="host"
[CI/test]   üê≥  docker run image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[] network="host"
[CI/lint]   üê≥  docker run image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[] network="host"
[CI/test]   üê≥  docker exec cmd=[node --no-warnings -e console.log(process.execPath)] user= workdir=
[CI/lint]   üê≥  docker exec cmd=[node --no-warnings -e console.log(process.execPath)] user= workdir=
[CI/test]   ‚úÖ  Success - Set up job
[CI/lint]   ‚úÖ  Success - Set up job
[CI/test]   ‚òÅ  git clone 'https://github.com/actions-rs/toolchain' # ref=v1
[CI/lint]   ‚òÅ  git clone 'https://github.com/actions-rs/toolchain' # ref=v1
[CI/fmt ]   üê≥  docker create image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[] network="host"
[CI/fmt ]   üê≥  docker run image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[] network="host"
[CI/fmt ]   üê≥  docker exec cmd=[node --no-warnings -e console.log(process.execPath)] user= workdir=
[CI/fmt ]   ‚úÖ  Success - Set up job
[CI/fmt ]   ‚òÅ  git clone 'https://github.com/actions-rs/toolchain' # ref=v1
[CI/test]   ‚òÅ  git clone 'https://github.com/swatinem/rust-cache' # ref=v2
[CI/lint]   ‚òÅ  git clone 'https://github.com/swatinem/rust-cache' # ref=v2
[CI/fmt ]   ‚òÅ  git clone 'https://github.com/swatinem/rust-cache' # ref=v2
[CI/test] ‚≠ê Run Main actions/checkout@v3
[CI/test]   üê≥  docker cp src=/home/marco/Projects/authly-rs/. dst=/home/marco/Projects/authly-rs
[CI/test]   ‚úÖ  Success - Main actions/checkout@v3
[CI/test] ‚≠ê Run Main Set up Rust
[CI/test]   üê≥  docker cp src=/home/marco/.cache/act/actions-rs-toolchain@v1/ dst=/var/run/act/actions/actions-rs-toolchain@v1/
[CI/test]   üê≥  docker exec cmd=[/opt/acttoolcache/node/18.20.8/x64/bin/node /var/run/act/actions/actions-rs-toolchain@v1/dist/index.js] user= workdir=
[CI/test]   | [command]/tmp/66b8cf79-8bfc-41e2-bded-1fa72bd35f38 --default-toolchain none -y
[CI/test]   | info: downloading installer
[CI/lint] ‚≠ê Run Main actions/checkout@v3
[CI/lint]   üê≥  docker cp src=/home/marco/Projects/authly-rs/. dst=/home/marco/Projects/authly-rs
[CI/lint]   ‚úÖ  Success - Main actions/checkout@v3
[CI/lint] ‚≠ê Run Main Set up Rust
[CI/lint]   üê≥  docker cp src=/home/marco/.cache/act/actions-rs-toolchain@v1/ dst=/var/run/act/actions/actions-rs-toolchain@v1/
[CI/lint]   üê≥  docker exec cmd=[/opt/acttoolcache/node/18.20.8/x64/bin/node /var/run/act/actions/actions-rs-toolchain@v1/dist/index.js] user= workdir=
[CI/lint]   | [command]/tmp/37952b3b-7b0c-4321-aa40-e31d3fe30b86 --default-toolchain none -y
[CI/lint]   | info: downloading installer
[CI/test]   | info: profile set to 'default'
[CI/test]   | info: default host triple is x86_64-unknown-linux-gnu
[CI/test]   | info: skipping toolchain installation
[CI/test]   | 
[CI/test]   | 
[CI/test]   | Rust is installed now. Great!
[CI/test]   | 
[CI/test]   | To get started you may need to restart your current shell.
[CI/test]   | This would reload your PATH environment variable to include
[CI/test]   | Cargo's bin directory ($HOME/.cargo/bin).
[CI/test]   | 
[CI/test]   | To configure your current shell, you need to source
[CI/test]   | the corresponding env file under $HOME/.cargo.
[CI/test]   | 
[CI/test]   | This is usually done by running one of the following (note the leading DOT):
[CI/test]   | . "$HOME/.cargo/env"            # For sh/bash/zsh/ash/dash/pdksh
[CI/test]   | source "$HOME/.cargo/env.fish"  # For fish
[CI/test]   | source $"($nu.home-path)/.cargo/env.nu"  # For nushell
[CI/test]   | [command]/root/.cargo/bin/rustup show
[CI/test]   | Default host: x86_64-unknown-linux-gnu
[CI/test]   | rustup home:  /root/.rustup
[CI/test]   | 
[CI/test]   | installed toolchains
[CI/test]   | --------------------
[CI/test]   | 
[CI/test]   | active toolchain
[CI/test]   | ----------------
[CI/test]   | no active toolchain
[CI/test]   | [command]/root/.cargo/bin/rustup toolchain install stable
[CI/test]   | info: syncing channel updates for 'stable-x86_64-unknown-linux-gnu'
[CI/fmt ] ‚≠ê Run Main actions/checkout@v3
[CI/fmt ]   üê≥  docker cp src=/home/marco/Projects/authly-rs/. dst=/home/marco/Projects/authly-rs
[CI/test]   | info: latest update on 2026-01-22, rust version 1.93.0 (254b59607 2026-01-19)
[CI/test]   | info: downloading component 'cargo'
[CI/fmt ]   ‚úÖ  Success - Main actions/checkout@v3
[CI/fmt ] ‚≠ê Run Main Set up Rust
[CI/fmt ]   üê≥  docker cp src=/home/marco/.cache/act/actions-rs-toolchain@v1/ dst=/var/run/act/actions/actions-rs-toolchain@v1/
[CI/fmt ]   üê≥  docker exec cmd=[/opt/acttoolcache/node/18.20.8/x64/bin/node /var/run/act/actions/actions-rs-toolchain@v1/dist/index.js] user= workdir=
[CI/lint]   | info: profile set to 'default'
[CI/lint]   | info: default host triple is x86_64-unknown-linux-gnu
[CI/lint]   | info: skipping toolchain installation
[CI/lint]   | 
[CI/lint]   | 
[CI/lint]   | Rust is installed now. Great!
[CI/lint]   | 
[CI/lint]   | To get started you may need to restart your current shell.
[CI/lint]   | This would reload your PATH environment variable to include
[CI/lint]   | Cargo's bin directory ($HOME/.cargo/bin).
[CI/lint]   | 
[CI/lint]   | To configure your current shell, you need to source
[CI/lint]   | the corresponding env file under $HOME/.cargo.
[CI/lint]   | 
[CI/lint]   | This is usually done by running one of the following (note the leading DOT):
[CI/lint]   | . "$HOME/.cargo/env"            # For sh/bash/zsh/ash/dash/pdksh
[CI/lint]   | source "$HOME/.cargo/env.fish"  # For fish
[CI/lint]   | source $"($nu.home-path)/.cargo/env.nu"  # For nushell
[CI/fmt ]   | [command]/tmp/ebd5cee6-1044-4ee6-a242-e4ba1ad7db95 --default-toolchain none -y
[CI/lint]   | [command]/root/.cargo/bin/rustup show
[CI/fmt ]   | info: downloading installer
[CI/lint]   | Default host: x86_64-unknown-linux-gnu
[CI/lint]   | rustup home:  /root/.rustup
[CI/lint]   | 
[CI/lint]   | installed toolchains
[CI/lint]   | --------------------
[CI/lint]   | 
[CI/lint]   | active toolchain
[CI/lint]   | ----------------
[CI/lint]   | no active toolchain
[CI/lint]   | [command]/root/.cargo/bin/rustup toolchain install stable
[CI/lint]   | info: syncing channel updates for 'stable-x86_64-unknown-linux-gnu'
[CI/test]   | info: downloading component 'clippy'
[CI/lint]   | info: latest update on 2026-01-22, rust version 1.93.0 (254b59607 2026-01-19)
[CI/lint]   | info: downloading component 'cargo'
[CI/test]   | info: downloading component 'rust-docs'
[CI/lint]   | info: downloading component 'clippy'
[CI/fmt ]   | info: profile set to 'default'
[CI/fmt ]   | info: default host triple is x86_64-unknown-linux-gnu
[CI/fmt ]   | info: skipping toolchain installation
[CI/fmt ]   | 
[CI/fmt ]   | 
[CI/fmt ]   | Rust is installed now. Great!
[CI/fmt ]   | 
[CI/fmt ]   | To get started you may need to restart your current shell.
[CI/fmt ]   | This would reload your PATH environment variable to include
[CI/fmt ]   | Cargo's bin directory ($HOME/.cargo/bin).
[CI/fmt ]   | 
[CI/fmt ]   | To configure your current shell, you need to source
[CI/fmt ]   | the corresponding env file under $HOME/.cargo.
[CI/fmt ]   | 
[CI/fmt ]   | This is usually done by running one of the following (note the leading DOT):
[CI/fmt ]   | . "$HOME/.cargo/env"            # For sh/bash/zsh/ash/dash/pdksh
[CI/fmt ]   | source "$HOME/.cargo/env.fish"  # For fish
[CI/fmt ]   | source $"($nu.home-path)/.cargo/env.nu"  # For nushell
[CI/fmt ]   | [command]/root/.cargo/bin/rustup show
[CI/fmt ]   | Default host: x86_64-unknown-linux-gnu
[CI/fmt ]   | rustup home:  /root/.rustup
[CI/fmt ]   | 
[CI/fmt ]   | installed toolchains
[CI/fmt ]   | --------------------
[CI/fmt ]   | 
[CI/fmt ]   | active toolchain
[CI/fmt ]   | ----------------
[CI/fmt ]   | no active toolchain
[CI/fmt ]   | [command]/root/.cargo/bin/rustup toolchain install stable
[CI/fmt ]   | info: syncing channel updates for 'stable-x86_64-unknown-linux-gnu'
[CI/test]   | info: downloading component 'rust-std'
[CI/fmt ]   | info: latest update on 2026-01-22, rust version 1.93.0 (254b59607 2026-01-19)
[CI/fmt ]   | info: downloading component 'cargo'
[CI/lint]   | info: downloading component 'rust-docs'
[CI/test]   | info: downloading component 'rustc'
[CI/fmt ]   | info: downloading component 'clippy'
[CI/fmt ]   | info: downloading component 'rust-docs'
[CI/lint]   | info: downloading component 'rust-std'
[CI/fmt ]   | info: downloading component 'rust-std'
[CI/lint]   | info: downloading component 'rustc'
[CI/test]   | info: downloading component 'rustfmt'
[CI/fmt ]   | info: downloading component 'rustc'
[CI/test]   | info: installing component 'cargo'
[CI/test]   | info: installing component 'clippy'
[CI/test]   | info: installing component 'rust-docs'
[CI/fmt ]   | info: downloading component 'rustfmt'
[CI/fmt ]   | info: installing component 'cargo'
[CI/test]   | info: installing component 'rust-std'
[CI/lint]   | info: downloading component 'rustfmt'
[CI/lint]   | info: installing component 'cargo'
[CI/fmt ]   | info: installing component 'clippy'
[CI/fmt ]   | info: installing component 'rust-docs'
[CI/lint]   | info: installing component 'clippy'
[CI/lint]   | info: installing component 'rust-docs'
[CI/test]   | info: installing component 'rustc'
[CI/fmt ]   | info: installing component 'rust-std'
[CI/lint]   | info: installing component 'rust-std'
[CI/fmt ]   | info: installing component 'rustc'
[CI/lint]   | info: installing component 'rustc'
[CI/test]   | info: installing component 'rustfmt'
[CI/test]   | 
[CI/test]   |   stable-x86_64-unknown-linux-gnu installed - rustc 1.93.0 (254b59607 2026-01-19)
[CI/test]   | 
[CI/test]   | info: default toolchain set to 'stable-x86_64-unknown-linux-gnu'
[CI/test]   | [command]/root/.cargo/bin/rustup override set stable
[CI/test]   | info: override toolchain for '/home/marco/Projects/authly-rs' set to 'stable-x86_64-unknown-linux-gnu'
[CI/test]   ‚ùì  ::group::Gathering installed versions
[CI/test]   | [command]/root/.cargo/bin/rustc -V
[CI/test]   | rustc 1.93.0 (254b59607 2026-01-19)
[CI/test]   ‚öô  ::set-output:: rustc=1.93.0 (254b59607 2026-01-19)
[CI/test]   ‚öô  ::set-output:: rustc_hash=254b59607
[CI/test]   | [command]/root/.cargo/bin/cargo -V
[CI/test]   | cargo 1.93.0 (083ac5135 2025-12-15)
[CI/test]   ‚öô  ::set-output:: cargo=1.93.0 (083ac5135 2025-12-15)
[CI/test]   | [command]/root/.cargo/bin/rustup -V
[CI/test]   | rustup 1.28.2 (e4f3ad6f8 2025-04-28)
[CI/test]   | info: This is the version for the rustup toolchain manager, not the rustc compiler.
[CI/test]   | info: The currently active `rustc` version is `rustc 1.93.0 (254b59607 2026-01-19)`
[CI/test]   ‚öô  ::set-output:: rustup=1.28.2 (e4f3ad6f8 2025-04-28)
[CI/test]   ‚ùì  ::endgroup::
[CI/test]   ‚úÖ  Success - Main Set up Rust
[CI/test]   ‚öô  ::add-path:: /root/.cargo/bin
[CI/test] ‚≠ê Run Main Cache cargo registry and build
[CI/test]   üê≥  docker cp src=/home/marco/.cache/act/swatinem-rust-cache@v2/ dst=/var/run/act/actions/swatinem-rust-cache@v2/
[CI/test]   üê≥  docker exec cmd=[/opt/acttoolcache/node/18.20.8/x64/bin/node /var/run/act/actions/swatinem-rust-cache@v2/dist/restore/index.js] user= workdir=
[CI/test]   ‚ùì  ::group::Cache Configuration
[CI/test]   | Cache Provider:
[CI/test]   |     github
[CI/test]   | Workspaces:
[CI/test]   |     /home/marco/Projects/authly-rs
[CI/test]   | Cache Paths:
[CI/test]   |     /root/.cargo/bin
[CI/test]   |     /root/.cargo/.crates.toml
[CI/test]   |     /root/.cargo/.crates2.json
[CI/test]   |     /root/.cargo/registry
[CI/test]   |     /root/.cargo/git
[CI/test]   |     /home/marco/Projects/authly-rs/target
[CI/test]   | Restore Key:
[CI/test]   |     v0-rust-test-Linux-x64-ac03b981
[CI/test]   | Cache Key:
[CI/test]   |     v0-rust-test-Linux-x64-ac03b981-69518b37
[CI/test]   | .. Prefix:
[CI/test]   |   - v0-rust-test-Linux-x64
[CI/test]   | .. Environment considered:
[CI/test]   |   - Rust Version: 1.93.0 x86_64-unknown-linux-gnu (254b59607d4417e9dffbc307138ae5c86280fe4c)
[CI/test]   |   - CARGO_INCREMENTAL
[CI/test]   | .. Lockfiles considered:
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-axum/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-core/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-flow/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-oidc/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-providers-discord/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-providers-github/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-providers-google/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-session/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-token/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/Cargo.lock
[CI/test]   ‚ùì  ::endgroup::
[CI/test]   | 
[CI/test]   | ... Restoring cache ...
[CI/test]   | No cache found.
[CI/test]   ‚úÖ  Success - Main Cache cargo registry and build
[CI/test]   ‚öô  ::set-env:: CACHE_ON_FAILURE=false
[CI/test]   ‚öô  ::set-env:: CARGO_INCREMENTAL=0
[CI/test]   ‚öô  ::set-output:: cache-hit=false
[CI/test] ‚≠ê Run Main Run tests
[CI/test]   üê≥  docker exec cmd=[bash -e /var/run/act/workflow/3] user= workdir=
[CI/test]   |     Updating crates.io index
[CI/fmt ]   | info: installing component 'rustfmt'
[CI/fmt ]   | 
[CI/fmt ]   |   stable-x86_64-unknown-linux-gnu installed - rustc 1.93.0 (254b59607 2026-01-19)
[CI/fmt ]   | 
[CI/fmt ]   | info: default toolchain set to 'stable-x86_64-unknown-linux-gnu'
[CI/fmt ]   | [command]/root/.cargo/bin/rustup override set stable
[CI/fmt ]   | info: override toolchain for '/home/marco/Projects/authly-rs' set to 'stable-x86_64-unknown-linux-gnu'
[CI/fmt ]   ‚ùì  ::group::Gathering installed versions
[CI/fmt ]   | [command]/root/.cargo/bin/rustc -V
[CI/fmt ]   | rustc 1.93.0 (254b59607 2026-01-19)
[CI/fmt ]   ‚öô  ::set-output:: rustc=1.93.0 (254b59607 2026-01-19)
[CI/fmt ]   ‚öô  ::set-output:: rustc_hash=254b59607
[CI/fmt ]   | [command]/root/.cargo/bin/cargo -V
[CI/fmt ]   | cargo 1.93.0 (083ac5135 2025-12-15)
[CI/fmt ]   ‚öô  ::set-output:: cargo=1.93.0 (083ac5135 2025-12-15)
[CI/fmt ]   | [command]/root/.cargo/bin/rustup -V
[CI/fmt ]   | rustup 1.28.2 (e4f3ad6f8 2025-04-28)
[CI/fmt ]   | info: This is the version for the rustup toolchain manager, not the rustc compiler.
[CI/fmt ]   | info: The currently active `rustc` version is `rustc 1.93.0 (254b59607 2026-01-19)`
[CI/fmt ]   ‚öô  ::set-output:: rustup=1.28.2 (e4f3ad6f8 2025-04-28)
[CI/fmt ]   ‚ùì  ::endgroup::
[CI/fmt ]   ‚úÖ  Success - Main Set up Rust
[CI/fmt ]   ‚öô  ::add-path:: /root/.cargo/bin
[CI/fmt ] ‚≠ê Run Main Cache cargo registry and build
[CI/fmt ]   üê≥  docker cp src=/home/marco/.cache/act/swatinem-rust-cache@v2/ dst=/var/run/act/actions/swatinem-rust-cache@v2/
[CI/fmt ]   üê≥  docker exec cmd=[/opt/acttoolcache/node/18.20.8/x64/bin/node /var/run/act/actions/swatinem-rust-cache@v2/dist/restore/index.js] user= workdir=
[CI/lint]   | info: installing component 'rustfmt'
[CI/lint]   | 
[CI/test]   |  Downloading crates ...
[CI/lint]   |   stable-x86_64-unknown-linux-gnu installed - rustc 1.93.0 (254b59607 2026-01-19)
[CI/lint]   | 
[CI/lint]   | info: default toolchain set to 'stable-x86_64-unknown-linux-gnu'
[CI/lint]   | [command]/root/.cargo/bin/rustup override set stable
[CI/lint]   | info: override toolchain for '/home/marco/Projects/authly-rs' set to 'stable-x86_64-unknown-linux-gnu'
[CI/lint]   ‚ùì  ::group::Gathering installed versions
[CI/lint]   | [command]/root/.cargo/bin/rustc -V
[CI/lint]   | rustc 1.93.0 (254b59607 2026-01-19)
[CI/lint]   ‚öô  ::set-output:: rustc=1.93.0 (254b59607 2026-01-19)
[CI/lint]   ‚öô  ::set-output:: rustc_hash=254b59607
[CI/lint]   | [command]/root/.cargo/bin/cargo -V
[CI/lint]   | cargo 1.93.0 (083ac5135 2025-12-15)
[CI/lint]   ‚öô  ::set-output:: cargo=1.93.0 (083ac5135 2025-12-15)
[CI/lint]   | [command]/root/.cargo/bin/rustup -V
[CI/lint]   | rustup 1.28.2 (e4f3ad6f8 2025-04-28)
[CI/lint]   | info: This is the version for the rustup toolchain manager, not the rustc compiler.
[CI/test]   |   Downloaded heck v0.5.0
[CI/test]   |   Downloaded atoi v2.0.0
[CI/test]   |   Downloaded openssl-probe v0.1.6
[CI/lint]   | info: The currently active `rustc` version is `rustc 1.93.0 (254b59607 2026-01-19)`
[CI/test]   |   Downloaded rand_chacha v0.3.1
[CI/lint]   ‚öô  ::set-output:: rustup=1.28.2 (e4f3ad6f8 2025-04-28)
[CI/lint]   ‚ùì  ::endgroup::
[CI/test]   |   Downloaded num-iter v0.1.45
[CI/lint]   ‚úÖ  Success - Main Set up Rust
[CI/test]   |   Downloaded displaydoc v0.2.5
[CI/test]   |   Downloaded form_urlencoded v1.2.2
[CI/lint]   ‚öô  ::add-path:: /root/.cargo/bin
[CI/fmt ]   ‚ùì  ::group::Cache Configuration
[CI/fmt ]   | Cache Provider:
[CI/fmt ]   |     github
[CI/fmt ]   | Workspaces:
[CI/fmt ]   |     /home/marco/Projects/authly-rs
[CI/fmt ]   | Cache Paths:
[CI/fmt ]   |     /root/.cargo/bin
[CI/fmt ]   |     /root/.cargo/.crates.toml
[CI/fmt ]   |     /root/.cargo/.crates2.json
[CI/fmt ]   |     /root/.cargo/registry
[CI/fmt ]   |     /root/.cargo/git
[CI/fmt ]   |     /home/marco/Projects/authly-rs/target
[CI/fmt ]   | Restore Key:
[CI/fmt ]   |     v0-rust-fmt-Linux-x64-ac03b981
[CI/fmt ]   | Cache Key:
[CI/fmt ]   |     v0-rust-fmt-Linux-x64-ac03b981-69518b37
[CI/fmt ]   | .. Prefix:
[CI/fmt ]   |   - v0-rust-fmt-Linux-x64
[CI/fmt ]   | .. Environment considered:
[CI/fmt ]   |   - Rust Version: 1.93.0 x86_64-unknown-linux-gnu (254b59607d4417e9dffbc307138ae5c86280fe4c)
[CI/fmt ]   |   - CARGO_INCREMENTAL
[CI/fmt ]   | .. Lockfiles considered:
[CI/fmt ]   |   - /home/marco/Projects/authly-rs/authly-axum/Cargo.toml
[CI/fmt ]   |   - /home/marco/Projects/authly-rs/authly-core/Cargo.toml
[CI/fmt ]   |   - /home/marco/Projects/authly-rs/authly-flow/Cargo.toml
[CI/fmt ]   |   - /home/marco/Projects/authly-rs/authly-oidc/Cargo.toml
[CI/fmt ]   |   - /home/marco/Projects/authly-rs/authly-providers-discord/Cargo.toml
[CI/fmt ]   |   - /home/marco/Projects/authly-rs/authly-providers-github/Cargo.toml
[CI/fmt ]   |   - /home/marco/Projects/authly-rs/authly-providers-google/Cargo.toml
[CI/fmt ]   |   - /home/marco/Projects/authly-rs/authly-session/Cargo.toml
[CI/fmt ]   |   - /home/marco/Projects/authly-rs/authly-token/Cargo.toml
[CI/fmt ]   |   - /home/marco/Projects/authly-rs/Cargo.lock
[CI/fmt ]   ‚ùì  ::endgroup::
[CI/fmt ]   | 
[CI/fmt ]   | ... Restoring cache ...
[CI/test]   |   Downloaded ppv-lite86 v0.2.21
[CI/test]   |   Downloaded synstructure v0.13.2
[CI/test]   |   Downloaded generic-array v0.14.7
[CI/test]   |   Downloaded idna_adapter v1.2.1
[CI/test]   |   Downloaded httpdate v1.0.3
[CI/fmt ]   | No cache found.
[CI/test]   |   Downloaded simple_asn1 v0.6.3
[CI/lint] ‚≠ê Run Main Cache cargo registry and build
[CI/test]   |   Downloaded stringprep v0.1.5
[CI/fmt ]   ‚úÖ  Success - Main Cache cargo registry and build
[CI/test]   |   Downloaded pem v3.0.6
[CI/fmt ]   ‚öô  ::set-env:: CACHE_ON_FAILURE=false
[CI/fmt ]   ‚öô  ::set-env:: CARGO_INCREMENTAL=0
[CI/lint]   üê≥  docker cp src=/home/marco/.cache/act/swatinem-rust-cache@v2/ dst=/var/run/act/actions/swatinem-rust-cache@v2/
[CI/test]   |   Downloaded lock_api v0.4.14
[CI/fmt ]   ‚öô  ::set-output:: cache-hit=false
[CI/test]   |   Downloaded time-core v0.1.7
[CI/test]   |   Downloaded http-body v1.0.1
[CI/test]   |   Downloaded ipnet v2.11.0
[CI/test]   |   Downloaded powerfmt v0.2.0
[CI/test]   |   Downloaded iana-time-zone v0.1.64
[CI/test]   |   Downloaded tower-cookies v0.10.0
[CI/fmt ] ‚≠ê Run Main Check formatting
[CI/test]   |   Downloaded spin v0.9.8
[CI/test]   |   Downloaded httparse v1.10.1
[CI/test]   |   Downloaded tower-layer v0.3.3
[CI/test]   |   Downloaded tokio-native-tls v0.3.1
[CI/test]   |   Downloaded want v0.3.1
[CI/test]   |   Downloaded webpki-roots v0.26.11
[CI/test]   |   Downloaded yoke-derive v0.8.1
[CI/test]   |   Downloaded bytes v1.11.0
[CI/fmt ]   üê≥  docker exec cmd=[bash -e /var/run/act/workflow/3] user= workdir=
[CI/test]   |   Downloaded sync_wrapper v0.1.2
[CI/test]   |   Downloaded whoami v1.6.1
[CI/test]   |   Downloaded num-integer v0.1.46
[CI/test]   |   Downloaded zmij v1.0.16
[CI/test]   |   Downloaded zerovec-derive v0.11.2
[CI/test]   |   Downloaded icu_locale_core v2.1.1
[CI/lint]   üê≥  docker exec cmd=[/opt/acttoolcache/node/18.20.8/x64/bin/node /var/run/act/actions/swatinem-rust-cache@v2/dist/restore/index.js] user= workdir=
[CI/test]   |   Downloaded yoke v0.8.1
[CI/test]   |   Downloaded tinyvec v1.10.0
[CI/test]   |   Downloaded uuid v1.19.0
[CI/test]   |   Downloaded unicode-bidi v0.3.18
[CI/test]   |   Downloaded typenum v1.19.0
[CI/test]   |   Downloaded zerotrie v0.2.3
[CI/test]   |   Downloaded sha1_smol v1.0.1
[CI/test]   |   Downloaded sqlx-macros v0.8.6
[CI/test]   |   Downloaded icu_properties_data v2.1.2
[CI/test]   |   Downloaded tokio-util v0.7.18
[CI/test]   |   Downloaded zerovec v0.11.5
[CI/test]   |   Downloaded unicode-normalization v0.1.25
[CI/test]   |   Downloaded zerofrom-derive v0.1.6
[CI/test]   |   Downloaded try-lock v0.2.5
[CI/test]   |   Downloaded zerofrom v0.1.6
[CI/test]   |   Downloaded urlencoding v2.1.3
[CI/test]   |   Downloaded webpki-roots v1.0.5
[CI/test]   |   Downloaded webpki-roots v0.25.4
[CI/test]   |   Downloaded zerocopy v0.8.33
[CI/test]   |   Downloaded signal-hook-registry v1.4.8
[CI/test]   |   Downloaded num-traits v0.2.19
[CI/test]   |   Downloaded log v0.4.29
[CI/test]   |   Downloaded zeroize v1.8.2
[CI/test]   |   Downloaded thiserror-impl v2.0.18
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-axum/src/helpers.rs:1:
[CI/fmt ]   | -use authly_core::{Identity, OAuthProvider, OAuthToken, pkce::Pkce};
[CI/fmt ]   | +use authly_core::{pkce::Pkce, Identity, OAuthProvider, OAuthToken};
[CI/fmt ]   |  use authly_flow::OAuth2Flow;
[CI/fmt ]   |  use authly_session::{Session, SessionStore};
[CI/fmt ]   |  use authly_token::TokenManager;
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-axum/src/helpers.rs:8:
[CI/fmt ]   |      Json,
[CI/fmt ]   |  };
[CI/fmt ]   |  use std::sync::Arc;
[CI/fmt ]   | -use tower_cookies::{Cookies, Cookie, cookie::SameSite};
[CI/fmt ]   | +use tower_cookies::{cookie::SameSite, Cookie, Cookies};
[CI/fmt ]   |  
[CI/fmt ]   |  #[derive(serde::Deserialize)]
[CI/fmt ]   |  pub struct OAuthCallbackParams {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-axum/src/helpers.rs:121:
[CI/fmt ]   |              Some(&pkce_verifier),
[CI/fmt ]   |          )
[CI/fmt ]   |          .await
[CI/fmt ]   | -        .map_err(|e| (StatusCode::UNAUTHORIZED, format!("Authentication failed: {}", e)))?;
[CI/fmt ]   | +        .map_err(|e| {
[CI/fmt ]   | +            (
[CI/fmt ]   | +                StatusCode::UNAUTHORIZED,
[CI/fmt ]   | +                format!("Authentication failed: {}", e),
[CI/fmt ]   | +            )
[CI/fmt ]   | +        })?;
[CI/fmt ]   |  
[CI/fmt ]   |      Ok((identity, token))
[CI/fmt ]   |  }
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-axum/src/helpers.rs:164:
[CI/fmt ]   |          expires_at: chrono::Utc::now() + session_duration,
[CI/fmt ]   |      };
[CI/fmt ]   |  
[CI/fmt ]   | -    store
[CI/fmt ]   | -        .save_session(&session)
[CI/fmt ]   | -        .await
[CI/fmt ]   | -        .map_err(|e| {
[CI/fmt ]   | -            (
[CI/fmt ]   | -                StatusCode::INTERNAL_SERVER_ERROR,
[CI/fmt ]   | -                format!("Failed to save session: {}", e),
[CI/fmt ]   | -            )
[CI/fmt ]   | -        })?;
[CI/fmt ]   | +    store.save_session(&session).await.map_err(|e| {
[CI/fmt ]   | +        (
[CI/fmt ]   | +            StatusCode::INTERNAL_SERVER_ERROR,
[CI/fmt ]   | +            format!("Failed to save session: {}", e),
[CI/fmt ]   | +        )
[CI/fmt ]   | +    })?;
[CI/fmt ]   |  
[CI/fmt ]   |      let cookie = config.create_cookie(session.id);
[CI/fmt ]   |      cookies.add(cookie);
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-axum/src/helpers.rs:196:
[CI/fmt ]   |  
[CI/fmt ]   |      let jwt = token_manager
[CI/fmt ]   |          .issue_user_token(identity, expires_in_secs, None)
[CI/fmt ]   | -        .map_err(|e| (StatusCode::INTERNAL_SERVER_ERROR, format!("Token error: {}", e)))?;
[CI/fmt ]   | +        .map_err(|e| {
[CI/fmt ]   | +            (
[CI/fmt ]   | +                StatusCode::INTERNAL_SERVER_ERROR,
[CI/fmt ]   | +                format!("Token error: {}", e),
[CI/fmt ]   | +            )
[CI/fmt ]   | +        })?;
[CI/fmt ]   |  
[CI/fmt ]   |      Ok(Json(serde_json::json!({
[CI/fmt ]   |          "access_token": jwt,
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-axum/src/lib.rs:50:
[CI/fmt ]   |  
[CI/fmt ]   |          let cookies = <Cookies as FromRequestParts<S>>::from_request_parts(parts, state)
[CI/fmt ]   |              .await
[CI/fmt ]   | -            .map_err(|_| (StatusCode::INTERNAL_SERVER_ERROR, "Cookies error".to_string()))?;
[CI/fmt ]   | +            .map_err(|_| {
[CI/fmt ]   | +                (
[CI/fmt ]   | +                    StatusCode::INTERNAL_SERVER_ERROR,
[CI/fmt ]   | +                    "Cookies error".to_string(),
[CI/fmt ]   | +                )
[CI/fmt ]   | +            })?;
[CI/fmt ]   |  
[CI/fmt ]   |          let session_id = cookies
[CI/fmt ]   |              .get(&config.cookie_name)
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-axum/src/lib.rs:57:
[CI/fmt ]   |              .map(|c: Cookie| c.value().to_string())
[CI/fmt ]   | -            .ok_or((StatusCode::UNAUTHORIZED, "Missing session cookie".to_string()))?;
[CI/fmt ]   | +            .ok_or((
[CI/fmt ]   | +                StatusCode::UNAUTHORIZED,
[CI/fmt ]   | +                "Missing session cookie".to_string(),
[CI/fmt ]   | +            ))?;
[CI/fmt ]   |  
[CI/fmt ]   |          let session = store
[CI/fmt ]   |              .load_session(&session_id)
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-axum/src/lib.rs:87:
[CI/fmt ]   |              .headers
[CI/fmt ]   |              .get(header::AUTHORIZATION)
[CI/fmt ]   |              .and_then(|h| h.to_str().ok())
[CI/fmt ]   | -            .ok_or((StatusCode::UNAUTHORIZED, "Missing Authorization header".to_string()))?;
[CI/fmt ]   | +            .ok_or((
[CI/fmt ]   | +                StatusCode::UNAUTHORIZED,
[CI/fmt ]   | +                "Missing Authorization header".to_string(),
[CI/fmt ]   | +            ))?;
[CI/fmt ]   |  
[CI/fmt ]   |          if !auth_header.starts_with("Bearer ") {
[CI/fmt ]   | -            return Err((StatusCode::UNAUTHORIZED, "Invalid Authorization header".to_string()));
[CI/fmt ]   | +            return Err((
[CI/fmt ]   | +                StatusCode::UNAUTHORIZED,
[CI/fmt ]   | +                "Invalid Authorization header".to_string(),
[CI/fmt ]   | +            ));
[CI/fmt ]   |          }
[CI/fmt ]   |  
[CI/fmt ]   |          let token = &auth_header[7..];
[CI/test]   |   Downloaded smallvec v1.15.1
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-core/src/lib.rs:66:
[CI/fmt ]   |  #[async_trait]
[CI/fmt ]   |  pub trait OAuthProvider: Send + Sync {
[CI/fmt ]   |      /// Helper to get the authorization URL.
[CI/fmt ]   | -    fn get_authorization_url(&self, state: &str, scopes: &[&str], code_challenge: Option<&str>) -> String;
[CI/fmt ]   | -    
[CI/fmt ]   | +    fn get_authorization_url(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        state: &str,
[CI/fmt ]   | +        scopes: &[&str],
[CI/fmt ]   | +        code_challenge: Option<&str>,
[CI/fmt ]   | +    ) -> String;
[CI/fmt ]   | +
[CI/fmt ]   |      /// Exchange an authorization code for an Identity.
[CI/fmt ]   | -    async fn exchange_code_for_identity(&self, code: &str, code_verifier: Option<&str>) -> Result<(Identity, OAuthToken), AuthError>;
[CI/fmt ]   | +    async fn exchange_code_for_identity(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        code: &str,
[CI/fmt ]   | +        code_verifier: Option<&str>,
[CI/fmt ]   | +    ) -> Result<(Identity, OAuthToken), AuthError>;
[CI/fmt ]   |  
[CI/fmt ]   |      /// Refresh an access token using a refresh token.
[CI/fmt ]   |      async fn refresh_token(&self, _refresh_token: &str) -> Result<OAuthToken, AuthError> {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-core/src/lib.rs:76:
[CI/fmt ]   | -        Err(AuthError::Provider("Token refresh not supported by this provider".into()))
[CI/fmt ]   | +        Err(AuthError::Provider(
[CI/fmt ]   | +            "Token refresh not supported by this provider".into(),
[CI/fmt ]   | +        ))
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      /// Revoke an access token.
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-core/src/lib.rs:80:
[CI/fmt ]   |      async fn revoke_token(&self, _token: &str) -> Result<(), AuthError> {
[CI/fmt ]   | -        Err(AuthError::Provider("Token revocation not supported by this provider".into()))
[CI/fmt ]   | +        Err(AuthError::Provider(
[CI/fmt ]   | +            "Token revocation not supported by this provider".into(),
[CI/fmt ]   | +        ))
[CI/fmt ]   |      }
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-core/src/lib.rs:86:
[CI/fmt ]   |  #[async_trait]
[CI/fmt ]   |  pub trait CredentialsProvider: Send + Sync {
[CI/fmt ]   |      type Credentials;
[CI/fmt ]   | -    
[CI/fmt ]   | +
[CI/fmt ]   |      /// Validate credentials and return an Identity.
[CI/fmt ]   |      async fn authenticate(&self, creds: Self::Credentials) -> Result<Identity, AuthError>;
[CI/fmt ]   |  }
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-core/src/lib.rs:108:
[CI/fmt ]   |          Ok(())
[CI/fmt ]   |      }
[CI/fmt ]   |  }
[CI/fmt ]   | -
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-core/src/pkce.rs:1:
[CI/fmt ]   | -use sha2::{Digest, Sha256};
[CI/fmt ]   | -use base64::{Engine as _, engine::general_purpose::URL_SAFE_NO_PAD};
[CI/fmt ]   | +use base64::{engine::general_purpose::URL_SAFE_NO_PAD, Engine as _};
[CI/fmt ]   |  use rand::distributions::Alphanumeric;
[CI/fmt ]   |  use rand::{thread_rng, Rng};
[CI/fmt ]   | +use sha2::{Digest, Sha256};
[CI/fmt ]   |  
[CI/fmt ]   |  /// Proof Key for Code Exchange (PKCE) parameters.
[CI/fmt ]   |  #[derive(Debug, Clone)]
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-flow/src/lib.rs:1:
[CI/fmt ]   | -use authly_core::{OAuthProvider, Identity, AuthError, CredentialsProvider, OAuthToken, UserMapper};
[CI/fmt ]   | +use authly_core::{
[CI/fmt ]   | +    AuthError, CredentialsProvider, Identity, OAuthProvider, OAuthToken, UserMapper,
[CI/fmt ]   | +};
[CI/fmt ]   |  
[CI/fmt ]   |  /// Orchestrates the Authorization Code flow.
[CI/fmt ]   |  pub struct OAuth2Flow<P: OAuthProvider, M: UserMapper = ()> {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-flow/src/lib.rs:8:
[CI/fmt ]   |  
[CI/fmt ]   |  impl<P: OAuthProvider> OAuth2Flow<P, ()> {
[CI/fmt ]   |      pub fn new(provider: P) -> Self {
[CI/fmt ]   | -        Self { provider, mapper: None }
[CI/fmt ]   | +        Self {
[CI/fmt ]   | +            provider,
[CI/fmt ]   | +            mapper: None,
[CI/fmt ]   | +        }
[CI/fmt ]   |      }
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-flow/src/lib.rs:15:
[CI/fmt ]   |  impl<P: OAuthProvider, M: UserMapper> OAuth2Flow<P, M> {
[CI/fmt ]   |      pub fn with_mapper(provider: P, mapper: M) -> Self {
[CI/fmt ]   | -        Self { provider, mapper: Some(mapper) }
[CI/fmt ]   | +        Self {
[CI/fmt ]   | +            provider,
[CI/fmt ]   | +            mapper: Some(mapper),
[CI/fmt ]   | +        }
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      /// Generates the redirect URL and CSRF state.
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-flow/src/lib.rs:21:
[CI/fmt ]   | -    pub fn initiate_login(&self, scopes: &[&str], pkce_challenge: Option<&str>) -> (String, String) {
[CI/fmt ]   | +    pub fn initiate_login(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        scopes: &[&str],
[CI/fmt ]   | +        pkce_challenge: Option<&str>,
[CI/fmt ]   | +    ) -> (String, String) {
[CI/fmt ]   |          let state = uuid::Uuid::new_v4().to_string();
[CI/fmt ]   | -        let url = self.provider.get_authorization_url(&state, scopes, pkce_challenge);
[CI/fmt ]   | +        let url = self
[CI/fmt ]   | +            .provider
[CI/fmt ]   | +            .get_authorization_url(&state, scopes, pkce_challenge);
[CI/fmt ]   |          (url, state)
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-flow/src/lib.rs:27:
[CI/fmt ]   |      /// Completes the flow by exchanging the code.
[CI/fmt ]   |      /// If a mapper is provided, it will also map the identity to a local user.
[CI/fmt ]   | -    pub async fn finalize_login(&self, code: &str, received_state: &str, expected_state: &str, pkce_verifier: Option<&str>) -> Result<(Identity, OAuthToken, Option<M::LocalUser>), AuthError> {
[CI/fmt ]   | +    pub async fn finalize_login(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        code: &str,
[CI/fmt ]   | +        received_state: &str,
[CI/fmt ]   | +        expected_state: &str,
[CI/fmt ]   | +        pkce_verifier: Option<&str>,
[CI/fmt ]   | +    ) -> Result<(Identity, OAuthToken, Option<M::LocalUser>), AuthError> {
[CI/fmt ]   |          if received_state != expected_state {
[CI/fmt ]   |              return Err(AuthError::CsrfMismatch);
[CI/fmt ]   |          }
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-flow/src/lib.rs:33:
[CI/fmt ]   | -        let (identity, token) = self.provider.exchange_code_for_identity(code, pkce_verifier).await?;
[CI/fmt ]   | -        
[CI/fmt ]   | +        let (identity, token) = self
[CI/fmt ]   | +            .provider
[CI/fmt ]   | +            .exchange_code_for_identity(code, pkce_verifier)
[CI/fmt ]   | +            .await?;
[CI/fmt ]   | +
[CI/fmt ]   |          let local_user = if let Some(mapper) = &self.mapper {
[CI/fmt ]   |              Some(mapper.map_user(&identity).await?)
[CI/fmt ]   |          } else {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-flow/src/lib.rs:60:
[CI/fmt ]   |  
[CI/fmt ]   |  impl<P: CredentialsProvider> CredentialsFlow<P, ()> {
[CI/fmt ]   |      pub fn new(provider: P) -> Self {
[CI/fmt ]   | -        Self { provider, mapper: None }
[CI/fmt ]   | +        Self {
[CI/fmt ]   | +            provider,
[CI/fmt ]   | +            mapper: None,
[CI/fmt ]   | +        }
[CI/fmt ]   |      }
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-flow/src/lib.rs:67:
[CI/fmt ]   |  impl<P: CredentialsProvider, M: UserMapper> CredentialsFlow<P, M> {
[CI/fmt ]   |      pub fn with_mapper(provider: P, mapper: M) -> Self {
[CI/fmt ]   | -        Self { provider, mapper: Some(mapper) }
[CI/fmt ]   | +        Self {
[CI/fmt ]   | +            provider,
[CI/fmt ]   | +            mapper: Some(mapper),
[CI/fmt ]   | +        }
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   | -    pub async fn authenticate(&self, creds: P::Credentials) -> Result<(Identity, Option<M::LocalUser>), AuthError> {
[CI/fmt ]   | +    pub async fn authenticate(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        creds: P::Credentials,
[CI/fmt ]   | +    ) -> Result<(Identity, Option<M::LocalUser>), AuthError> {
[CI/fmt ]   |          let identity = self.provider.authenticate(creds).await?;
[CI/fmt ]   | -        
[CI/fmt ]   | +
[CI/fmt ]   |          let local_user = if let Some(mapper) = &self.mapper {
[CI/fmt ]   |              Some(mapper.map_user(&identity).await?)
[CI/fmt ]   |          } else {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-flow/src/lib.rs:81:
[CI/fmt ]   |          Ok((identity, local_user))
[CI/fmt ]   |      }
[CI/fmt ]   |  }
[CI/fmt ]   | -
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/discovery.rs:1:
[CI/fmt ]   | -use serde::Deserialize;
[CI/fmt ]   |  use crate::error::OidcError;
[CI/fmt ]   | +use serde::Deserialize;
[CI/fmt ]   |  
[CI/fmt ]   |  #[derive(Debug, Clone, Deserialize)]
[CI/fmt ]   |  pub struct ProviderMetadata {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/discovery.rs:18:
[CI/fmt ]   |      pub async fn discover(issuer_url: &str, client: &reqwest::Client) -> Result<Self, OidcError> {
[CI/fmt ]   |          let mut url = url::Url::parse(issuer_url)
[CI/fmt ]   |              .map_err(|e| OidcError::Discovery(format!("Invalid issuer URL: {}", e)))?;
[CI/fmt ]   | -        
[CI/fmt ]   | +
[CI/fmt ]   |          {
[CI/fmt ]   | -            let mut path = url.path_segments_mut().map_err(|_| OidcError::Discovery("Cannot append to issuer URL".to_string()))?;
[CI/fmt ]   | +            let mut path = url
[CI/fmt ]   | +                .path_segments_mut()
[CI/fmt ]   | +                .map_err(|_| OidcError::Discovery("Cannot append to issuer URL".to_string()))?;
[CI/fmt ]   |              path.push(".well-known");
[CI/fmt ]   |              path.push("openid-configuration");
[CI/fmt ]   |          }
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/discovery.rs:27:
[CI/fmt ]   |  
[CI/fmt ]   | -        let metadata = client.get(url)
[CI/fmt ]   | +        let metadata = client
[CI/fmt ]   | +            .get(url)
[CI/fmt ]   |              .send()
[CI/fmt ]   |              .await
[CI/fmt ]   |              .map_err(|e| OidcError::Network(e.to_string()))?
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/error.rs:1:
[CI/fmt ]   | -use thiserror::Error;
[CI/fmt ]   |  use authly_core::AuthError;
[CI/fmt ]   | +use thiserror::Error;
[CI/fmt ]   |  
[CI/fmt ]   |  #[derive(Debug, Error)]
[CI/fmt ]   |  pub enum OidcError {
[CI/test]   |   Downloaded serde_json v1.0.149
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/jwks.rs:1:
[CI/fmt ]   | -use serde::Deserialize;
[CI/fmt ]   |  use crate::error::OidcError;
[CI/fmt ]   |  use jsonwebtoken::DecodingKey;
[CI/fmt ]   | +use serde::Deserialize;
[CI/fmt ]   |  
[CI/fmt ]   |  #[derive(Debug, Clone, Deserialize)]
[CI/fmt ]   |  pub struct Jwks {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/jwks.rs:18:
[CI/fmt ]   |  
[CI/fmt ]   |  impl Jwks {
[CI/fmt ]   |      pub async fn fetch(jwks_uri: &str, client: &reqwest::Client) -> Result<Self, OidcError> {
[CI/fmt ]   | -        client.get(jwks_uri)
[CI/fmt ]   | +        client
[CI/fmt ]   | +            .get(jwks_uri)
[CI/fmt ]   |              .send()
[CI/fmt ]   |              .await
[CI/fmt ]   |              .map_err(|e| OidcError::Network(e.to_string()))?
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/jwks.rs:38:
[CI/fmt ]   |  impl Jwk {
[CI/fmt ]   |      pub fn to_decoding_key(&self) -> Result<DecodingKey, OidcError> {
[CI/fmt ]   |          if self.kty != "RSA" {
[CI/fmt ]   | -            return Err(OidcError::ValidationError("Only RSA keys are supported currently".to_string()));
[CI/fmt ]   | +            return Err(OidcError::ValidationError(
[CI/fmt ]   | +                "Only RSA keys are supported currently".to_string(),
[CI/fmt ]   | +            ));
[CI/fmt ]   |          }
[CI/fmt ]   |  
[CI/fmt ]   | -        let n = self.n.as_ref().ok_or_else(|| OidcError::ValidationError("Missing 'n' component in JWK".to_string()))?;
[CI/fmt ]   | -        let e = self.e.as_ref().ok_or_else(|| OidcError::ValidationError("Missing 'e' component in JWK".to_string()))?;
[CI/fmt ]   | +        let n = self.n.as_ref().ok_or_else(|| {
[CI/fmt ]   | +            OidcError::ValidationError("Missing 'n' component in JWK".to_string())
[CI/fmt ]   | +        })?;
[CI/fmt ]   | +        let e = self.e.as_ref().ok_or_else(|| {
[CI/fmt ]   | +            OidcError::ValidationError("Missing 'e' component in JWK".to_string())
[CI/fmt ]   | +        })?;
[CI/fmt ]   |  
[CI/fmt ]   |          DecodingKey::from_rsa_components(n, e)
[CI/fmt ]   |              .map_err(|e| OidcError::ValidationError(format!("Invalid RSA components: {}", e)))
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/provider.rs:1:
[CI/fmt ]   | +use crate::discovery::ProviderMetadata;
[CI/fmt ]   | +use crate::error::OidcError;
[CI/fmt ]   | +use crate::jwks::Jwks;
[CI/fmt ]   |  use async_trait::async_trait;
[CI/fmt ]   |  use authly_core::{AuthError, Identity, OAuthProvider, OAuthToken};
[CI/fmt ]   | +use jsonwebtoken::{decode, decode_header, Algorithm, Validation};
[CI/fmt ]   |  use serde::{Deserialize, Serialize};
[CI/fmt ]   |  use std::collections::HashMap;
[CI/fmt ]   | -use crate::discovery::ProviderMetadata;
[CI/fmt ]   | -use crate::error::OidcError;
[CI/fmt ]   | -use crate::jwks::Jwks;
[CI/fmt ]   | -use jsonwebtoken::{decode, decode_header, Validation, Algorithm};
[CI/fmt ]   |  
[CI/fmt ]   |  pub struct OidcProvider {
[CI/fmt ]   |      client_id: String,
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/provider.rs:42:
[CI/fmt ]   |          client_id: String,
[CI/fmt ]   |          client_secret: String,
[CI/fmt ]   |          redirect_uri: String,
[CI/fmt ]   | -        issuer_url: &str
[CI/fmt ]   | +        issuer_url: &str,
[CI/fmt ]   |      ) -> Result<Self, OidcError> {
[CI/fmt ]   |          let client = reqwest::Client::new();
[CI/fmt ]   |          let metadata = ProviderMetadata::discover(issuer_url, &client).await?;
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/provider.rs:62:
[CI/fmt ]   |  
[CI/fmt ]   |  #[async_trait]
[CI/fmt ]   |  impl OAuthProvider for OidcProvider {
[CI/fmt ]   | -    fn get_authorization_url(&self, state: &str, scopes: &[&str], code_challenge: Option<&str>) -> String {
[CI/fmt ]   | +    fn get_authorization_url(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        state: &str,
[CI/fmt ]   | +        scopes: &[&str],
[CI/fmt ]   | +        code_challenge: Option<&str>,
[CI/fmt ]   | +    ) -> String {
[CI/fmt ]   |          let mut full_scopes = scopes.to_vec();
[CI/fmt ]   |          if !full_scopes.contains(&"openid") {
[CI/fmt ]   |              full_scopes.push("openid");
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/provider.rs:69:
[CI/fmt ]   |          }
[CI/fmt ]   | -        
[CI/fmt ]   | +
[CI/fmt ]   |          let scope_param = full_scopes.join(" ");
[CI/fmt ]   |  
[CI/fmt ]   |          let mut url = format!(
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/provider.rs:80:
[CI/fmt ]   |          );
[CI/fmt ]   |  
[CI/fmt ]   |          if let Some(challenge) = code_challenge {
[CI/fmt ]   | -            url.push_str(&format!("&code_challenge={}&code_challenge_method=S256", challenge));
[CI/fmt ]   | +            url.push_str(&format!(
[CI/fmt ]   | +                "&code_challenge={}&code_challenge_method=S256",
[CI/fmt ]   | +                challenge
[CI/fmt ]   | +            ));
[CI/fmt ]   |          }
[CI/fmt ]   |  
[CI/fmt ]   |          url
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/provider.rs:87:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   | -    async fn exchange_code_for_identity(&self, code: &str, code_verifier: Option<&str>) -> Result<(Identity, OAuthToken), AuthError> {
[CI/fmt ]   | +    async fn exchange_code_for_identity(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        code: &str,
[CI/fmt ]   | +        code_verifier: Option<&str>,
[CI/fmt ]   | +    ) -> Result<(Identity, OAuthToken), AuthError> {
[CI/fmt ]   |          // 1. Exchange code for tokens
[CI/fmt ]   |          let mut params = vec![
[CI/fmt ]   |              ("grant_type", "authorization_code".to_string()),
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/provider.rs:100:
[CI/fmt ]   |              params.push(("code_verifier", verifier.to_string()));
[CI/fmt ]   |          }
[CI/fmt ]   |  
[CI/fmt ]   | -        let token_response = self.http_client
[CI/fmt ]   | +        let token_response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .post(&self.metadata.token_endpoint)
[CI/fmt ]   |              .form(&params)
[CI/fmt ]   |              .send()
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/provider.rs:110:
[CI/fmt ]   |              .await
[CI/fmt ]   |              .map_err(|e| AuthError::Provider(format!("Failed to parse token response: {}", e)))?;
[CI/fmt ]   |  
[CI/fmt ]   | -        let id_token = token_response.id_token.ok_or_else(|| AuthError::Token("Missing id_token in response".to_string()))?;
[CI/fmt ]   | +        let id_token = token_response
[CI/fmt ]   | +            .id_token
[CI/fmt ]   | +            .ok_or_else(|| AuthError::Token("Missing id_token in response".to_string()))?;
[CI/fmt ]   |  
[CI/fmt ]   |          // 2. Fetch JWKS
[CI/fmt ]   | -        let jwks = Jwks::fetch(&self.metadata.jwks_uri, &self.http_client).await
[CI/fmt ]   | +        let jwks = Jwks::fetch(&self.metadata.jwks_uri, &self.http_client)
[CI/fmt ]   | +            .await
[CI/fmt ]   |              .map_err(|e| AuthError::from(e))?;
[CI/fmt ]   |  
[CI/fmt ]   |          // 3. Decode and Validate ID Token
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/provider.rs:120:
[CI/fmt ]   |          let header = decode_header(&id_token)
[CI/fmt ]   |              .map_err(|e| AuthError::Token(format!("Invalid ID Token header: {}", e)))?;
[CI/fmt ]   | -        
[CI/fmt ]   | -        let jwk = jwks.find_key(header.kid.as_deref())
[CI/fmt ]   | +
[CI/fmt ]   | +        let jwk = jwks
[CI/fmt ]   | +            .find_key(header.kid.as_deref())
[CI/fmt ]   |              .ok_or_else(|| AuthError::Token("No matching key found in JWKS".to_string()))?;
[CI/fmt ]   |  
[CI/fmt ]   | -        let decoding_key = jwk.to_decoding_key()
[CI/fmt ]   | -            .map_err(|e| AuthError::from(e))?;
[CI/fmt ]   | +        let decoding_key = jwk.to_decoding_key().map_err(|e| AuthError::from(e))?;
[CI/fmt ]   |  
[CI/fmt ]   |          let mut validation = Validation::new(Algorithm::RS256);
[CI/fmt ]   |          validation.set_issuer(&[self.metadata.issuer.clone()]);
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-oidc/src/provider.rs:131:
[CI/fmt ]   |          validation.set_audience(&[self.client_id.clone()]);
[CI/fmt ]   |  
[CI/fmt ]   | -        let token_data = decode::<Claims>(
[CI/fmt ]   | -            &id_token,
[CI/fmt ]   | -            &decoding_key,
[CI/fmt ]   | -            &validation
[CI/fmt ]   | -        ).map_err(|e| AuthError::Token(format!("ID Token validation failed: {}", e)))?;
[CI/fmt ]   | +        let token_data = decode::<Claims>(&id_token, &decoding_key, &validation)
[CI/fmt ]   | +            .map_err(|e| AuthError::Token(format!("ID Token validation failed: {}", e)))?;
[CI/fmt ]   |  
[CI/fmt ]   |          let claims = token_data.claims;
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:27:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      #[cfg(test)]
[CI/fmt ]   | -    pub(crate) fn with_test_urls(mut self, token_url: String, user_url: String, revoke_url: String) -> Self {
[CI/fmt ]   | +    pub(crate) fn with_test_urls(
[CI/fmt ]   | +        mut self,
[CI/fmt ]   | +        token_url: String,
[CI/fmt ]   | +        user_url: String,
[CI/fmt ]   | +        revoke_url: String,
[CI/fmt ]   | +    ) -> Self {
[CI/fmt ]   |          self.token_url = token_url;
[CI/fmt ]   |          self.user_url = user_url;
[CI/fmt ]   |          self.revoke_url = revoke_url;
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:55:
[CI/fmt ]   |  
[CI/fmt ]   |  #[async_trait]
[CI/fmt ]   |  impl OAuthProvider for DiscordProvider {
[CI/fmt ]   | -    fn get_authorization_url(&self, state: &str, scopes: &[&str], code_challenge: Option<&str>) -> String {
[CI/fmt ]   | +    fn get_authorization_url(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        state: &str,
[CI/fmt ]   | +        scopes: &[&str],
[CI/fmt ]   | +        code_challenge: Option<&str>,
[CI/fmt ]   | +    ) -> String {
[CI/fmt ]   |          let scope_param = if scopes.is_empty() {
[CI/fmt ]   |              "identify email".to_string()
[CI/fmt ]   |          } else {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:68:
[CI/fmt ]   |          );
[CI/fmt ]   |  
[CI/fmt ]   |          if let Some(challenge) = code_challenge {
[CI/fmt ]   | -            url.push_str(&format!("&code_challenge={}&code_challenge_method=S256", challenge));
[CI/fmt ]   | +            url.push_str(&format!(
[CI/fmt ]   | +                "&code_challenge={}&code_challenge_method=S256",
[CI/fmt ]   | +                challenge
[CI/fmt ]   | +            ));
[CI/fmt ]   |          }
[CI/fmt ]   |  
[CI/fmt ]   |          url
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:75:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   | -    async fn exchange_code_for_identity(&self, code: &str, code_verifier: Option<&str>) -> Result<(Identity, OAuthToken), AuthError> {
[CI/fmt ]   | +    async fn exchange_code_for_identity(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        code: &str,
[CI/fmt ]   | +        code_verifier: Option<&str>,
[CI/fmt ]   | +    ) -> Result<(Identity, OAuthToken), AuthError> {
[CI/fmt ]   |          // 1. Exchange code for access token
[CI/fmt ]   |          let mut params = vec![
[CI/fmt ]   |              ("client_id", self.client_id.clone()),
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:88:
[CI/fmt ]   |              params.push(("code_verifier", verifier.to_string()));
[CI/fmt ]   |          }
[CI/fmt ]   |  
[CI/fmt ]   | -        let token_response = self.http_client
[CI/fmt ]   | +        let token_response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .post(&self.token_url)
[CI/fmt ]   |              .form(&params)
[CI/fmt ]   |              .send()
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:99:
[CI/fmt ]   |              .map_err(|e| AuthError::Provider(format!("Failed to parse token response: {}", e)))?;
[CI/fmt ]   |  
[CI/fmt ]   |          // 2. Get user information
[CI/fmt ]   | -        let user_response = self.http_client
[CI/fmt ]   | +        let user_response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .get(&self.user_url)
[CI/fmt ]   | -            .header("Authorization", format!("Bearer {}", token_response.access_token))
[CI/fmt ]   | +            .header(
[CI/fmt ]   | +                "Authorization",
[CI/fmt ]   | +                format!("Bearer {}", token_response.access_token),
[CI/fmt ]   | +            )
[CI/fmt ]   |              .send()
[CI/fmt ]   |              .await
[CI/fmt ]   |              .map_err(|_| AuthError::Network)?
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:137:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      async fn refresh_token(&self, refresh_token: &str) -> Result<OAuthToken, AuthError> {
[CI/fmt ]   | -        let token_response = self.http_client
[CI/fmt ]   | +        let token_response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .post(&self.token_url)
[CI/fmt ]   |              .form(&[
[CI/fmt ]   |                  ("client_id", &self.client_id),
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:150:
[CI/fmt ]   |              .map_err(|_| AuthError::Network)?
[CI/fmt ]   |              .json::<DiscordAccessTokenResponse>()
[CI/fmt ]   |              .await
[CI/fmt ]   | -            .map_err(|e| AuthError::Provider(format!("Failed to parse refresh token response: {}", e)))?;
[CI/fmt ]   | +            .map_err(|e| {
[CI/fmt ]   | +                AuthError::Provider(format!("Failed to parse refresh token response: {}", e))
[CI/fmt ]   | +            })?;
[CI/fmt ]   |  
[CI/fmt ]   |          Ok(OAuthToken {
[CI/fmt ]   |              access_token: token_response.access_token,
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:157:
[CI/fmt ]   |              token_type: token_response.token_type,
[CI/fmt ]   |              expires_in: token_response.expires_in,
[CI/fmt ]   | -            refresh_token: token_response.refresh_token.or_else(|| Some(refresh_token.to_string())),
[CI/fmt ]   | +            refresh_token: token_response
[CI/fmt ]   | +                .refresh_token
[CI/fmt ]   | +                .or_else(|| Some(refresh_token.to_string())),
[CI/fmt ]   |              scope: token_response.scope,
[CI/fmt ]   |              id_token: token_response.id_token,
[CI/fmt ]   |          })
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:163:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      async fn revoke_token(&self, token: &str) -> Result<(), AuthError> {
[CI/fmt ]   | -        let response = self.http_client
[CI/fmt ]   | +        let response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .post(&self.revoke_url)
[CI/fmt ]   |              .form(&[
[CI/fmt ]   |                  ("client_id", &self.client_id),
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:177:
[CI/fmt ]   |          if response.status().is_success() {
[CI/fmt ]   |              Ok(())
[CI/fmt ]   |          } else {
[CI/fmt ]   | -            let error_text = response.text().await.unwrap_or_else(|_| "Unknown error".to_string());
[CI/fmt ]   | -            Err(AuthError::Provider(format!("Failed to revoke token: {}", error_text)))
[CI/fmt ]   | +            let error_text = response
[CI/fmt ]   | +                .text()
[CI/fmt ]   | +                .await
[CI/fmt ]   | +                .unwrap_or_else(|_| "Unknown error".to_string());
[CI/fmt ]   | +            Err(AuthError::Provider(format!(
[CI/fmt ]   | +                "Failed to revoke token: {}",
[CI/fmt ]   | +                error_text
[CI/fmt ]   | +            )))
[CI/fmt ]   |          }
[CI/fmt ]   |      }
[CI/fmt ]   |  }
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:194:
[CI/fmt ]   |          let token_url = format!("{}/api/oauth2/token", server.url());
[CI/fmt ]   |          let user_url = format!("{}/api/users/@me", server.url());
[CI/fmt ]   |  
[CI/fmt ]   | -        let _token_mock = server.mock("POST", "/api/oauth2/token")
[CI/fmt ]   | +        let _token_mock = server
[CI/fmt ]   | +            .mock("POST", "/api/oauth2/token")
[CI/fmt ]   |              .with_status(200)
[CI/fmt ]   |              .with_header("content-type", "application/json")
[CI/fmt ]   |              .with_body(r#"{"access_token": "test_token", "token_type": "Bearer"}"#)
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-discord/src/lib.rs:212:
[CI/fmt ]   |              "client_id".to_string(),
[CI/fmt ]   |              "client_secret".to_string(),
[CI/fmt ]   |              "http://localhost/callback".to_string(),
[CI/fmt ]   | -        ).with_test_urls(token_url, user_url, "http://localhost/api/oauth2/token/revoke".to_string());
[CI/fmt ]   | +        )
[CI/fmt ]   | +        .with_test_urls(
[CI/fmt ]   | +            token_url,
[CI/fmt ]   | +            user_url,
[CI/fmt ]   | +            "http://localhost/api/oauth2/token/revoke".to_string(),
[CI/fmt ]   | +        );
[CI/fmt ]   |  
[CI/fmt ]   | -        let (identity, token) = provider.exchange_code_for_identity("test_code", None).await.unwrap();
[CI/fmt ]   | +        let (identity, token) = provider
[CI/fmt ]   | +            .exchange_code_for_identity("test_code", None)
[CI/fmt ]   | +            .await
[CI/fmt ]   | +            .unwrap();
[CI/fmt ]   |  
[CI/fmt ]   |          assert_eq!(identity.provider_id, "discord");
[CI/fmt ]   |          assert_eq!(identity.external_id, "123456789");
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-github/src/lib.rs:56:
[CI/fmt ]   |  
[CI/fmt ]   |  #[async_trait]
[CI/fmt ]   |  impl OAuthProvider for GithubProvider {
[CI/fmt ]   | -    fn get_authorization_url(&self, state: &str, scopes: &[&str], _code_challenge: Option<&str>) -> String {
[CI/fmt ]   | +    fn get_authorization_url(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        state: &str,
[CI/fmt ]   | +        scopes: &[&str],
[CI/fmt ]   | +        _code_challenge: Option<&str>,
[CI/fmt ]   | +    ) -> String {
[CI/fmt ]   |          let scope_param = if scopes.is_empty() {
[CI/fmt ]   |              "user:email".to_string()
[CI/fmt ]   |          } else {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-github/src/lib.rs:69:
[CI/fmt ]   |          )
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   | -    async fn exchange_code_for_identity(&self, code: &str, _code_verifier: Option<&str>) -> Result<(Identity, OAuthToken), AuthError> {
[CI/fmt ]   | +    async fn exchange_code_for_identity(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        code: &str,
[CI/fmt ]   | +        _code_verifier: Option<&str>,
[CI/fmt ]   | +    ) -> Result<(Identity, OAuthToken), AuthError> {
[CI/fmt ]   |          // 1. Exchange code for access token
[CI/fmt ]   | -        let token_response = self.http_client
[CI/fmt ]   | +        let token_response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .post(&self.token_url)
[CI/fmt ]   |              .header("Accept", "application/json")
[CI/fmt ]   |              .form(&[
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-github/src/lib.rs:88:
[CI/fmt ]   |              .map_err(|e| AuthError::Provider(format!("Failed to parse token response: {}", e)))?;
[CI/fmt ]   |  
[CI/fmt ]   |          // 2. Get user information
[CI/fmt ]   | -        let user_response = self.http_client
[CI/fmt ]   | +        let user_response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .get(&self.user_url)
[CI/fmt ]   | -            .header("Authorization", format!("Bearer {}", token_response.access_token))
[CI/fmt ]   | +            .header(
[CI/fmt ]   | +                "Authorization",
[CI/fmt ]   | +                format!("Bearer {}", token_response.access_token),
[CI/fmt ]   | +            )
[CI/fmt ]   |              .header("User-Agent", "authly-rs")
[CI/fmt ]   |              .send()
[CI/fmt ]   |              .await
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-github/src/lib.rs:121:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      async fn refresh_token(&self, refresh_token: &str) -> Result<OAuthToken, AuthError> {
[CI/fmt ]   | -        let token_response = self.http_client
[CI/fmt ]   | +        let token_response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .post(&self.token_url)
[CI/fmt ]   |              .header("Accept", "application/json")
[CI/fmt ]   |              .form(&[
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-github/src/lib.rs:135:
[CI/fmt ]   |              .map_err(|_| AuthError::Network)?
[CI/fmt ]   |              .json::<GithubAccessTokenResponse>()
[CI/fmt ]   |              .await
[CI/fmt ]   | -            .map_err(|e| AuthError::Provider(format!("Failed to parse refresh token response: {}", e)))?;
[CI/fmt ]   | +            .map_err(|e| {
[CI/fmt ]   | +                AuthError::Provider(format!("Failed to parse refresh token response: {}", e))
[CI/fmt ]   | +            })?;
[CI/fmt ]   |  
[CI/fmt ]   |          Ok(OAuthToken {
[CI/fmt ]   |              access_token: token_response.access_token,
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-github/src/lib.rs:142:
[CI/fmt ]   |              token_type: token_response.token_type,
[CI/fmt ]   |              expires_in: token_response.expires_in,
[CI/fmt ]   | -            refresh_token: token_response.refresh_token.or_else(|| Some(refresh_token.to_string())),
[CI/fmt ]   | +            refresh_token: token_response
[CI/fmt ]   | +                .refresh_token
[CI/fmt ]   | +                .or_else(|| Some(refresh_token.to_string())),
[CI/fmt ]   |              scope: token_response.scope,
[CI/fmt ]   |              id_token: token_response.id_token,
[CI/fmt ]   |          })
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-github/src/lib.rs:148:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      async fn revoke_token(&self, token: &str) -> Result<(), AuthError> {
[CI/fmt ]   | -        let response = self.http_client
[CI/fmt ]   | -            .delete(format!("https://api.github.com/applications/{}/token", self.client_id))
[CI/fmt ]   | +        let response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   | +            .delete(format!(
[CI/fmt ]   | +                "https://api.github.com/applications/{}/token",
[CI/fmt ]   | +                self.client_id
[CI/fmt ]   | +            ))
[CI/fmt ]   |              .basic_auth(&self.client_id, Some(&self.client_secret))
[CI/fmt ]   |              .header("User-Agent", "authly-rs")
[CI/fmt ]   |              .json(&serde_json::json!({
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-github/src/lib.rs:162:
[CI/fmt ]   |          if response.status().is_success() || response.status() == reqwest::StatusCode::NO_CONTENT {
[CI/fmt ]   |              Ok(())
[CI/fmt ]   |          } else {
[CI/fmt ]   | -            let error_text = response.text().await.unwrap_or_else(|_| "Unknown error".to_string());
[CI/fmt ]   | -            Err(AuthError::Provider(format!("Failed to revoke token: {}", error_text)))
[CI/fmt ]   | +            let error_text = response
[CI/fmt ]   | +                .text()
[CI/fmt ]   | +                .await
[CI/fmt ]   | +                .unwrap_or_else(|_| "Unknown error".to_string());
[CI/fmt ]   | +            Err(AuthError::Provider(format!(
[CI/fmt ]   | +                "Failed to revoke token: {}",
[CI/fmt ]   | +                error_text
[CI/fmt ]   | +            )))
[CI/fmt ]   |          }
[CI/fmt ]   |      }
[CI/fmt ]   |  }
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-github/src/lib.rs:179:
[CI/fmt ]   |          let token_url = format!("{}/login/oauth/access_token", server.url());
[CI/fmt ]   |          let user_url = format!("{}/user", server.url());
[CI/fmt ]   |  
[CI/fmt ]   | -        let _token_mock = server.mock("POST", "/login/oauth/access_token")
[CI/fmt ]   | +        let _token_mock = server
[CI/fmt ]   | +            .mock("POST", "/login/oauth/access_token")
[CI/fmt ]   |              .with_status(200)
[CI/fmt ]   |              .with_header("content-type", "application/json")
[CI/fmt ]   |              .with_body(r#"{"access_token": "test_token", "token_type": "bearer"}"#)
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-github/src/lib.rs:186:
[CI/fmt ]   |              .create_async()
[CI/fmt ]   |              .await;
[CI/fmt ]   |  
[CI/fmt ]   | -        let _user_mock = server.mock("GET", "/user")
[CI/fmt ]   | +        let _user_mock = server
[CI/fmt ]   | +            .mock("GET", "/user")
[CI/fmt ]   |              .with_status(200)
[CI/fmt ]   |              .with_header("content-type", "application/json")
[CI/fmt ]   |              .with_body(r#"{"id": 123, "login": "testuser", "email": "test@example.com"}"#)
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-github/src/lib.rs:197:
[CI/fmt ]   |              "client_id".to_string(),
[CI/fmt ]   |              "client_secret".to_string(),
[CI/fmt ]   |              "http://localhost/callback".to_string(),
[CI/fmt ]   | -        ).with_test_urls(token_url, user_url);
[CI/fmt ]   | +        )
[CI/fmt ]   | +        .with_test_urls(token_url, user_url);
[CI/fmt ]   |  
[CI/fmt ]   | -        let (identity, token) = provider.exchange_code_for_identity("test_code", None).await.unwrap();
[CI/fmt ]   | +        let (identity, token) = provider
[CI/fmt ]   | +            .exchange_code_for_identity("test_code", None)
[CI/fmt ]   | +            .await
[CI/fmt ]   | +            .unwrap();
[CI/fmt ]   |  
[CI/fmt ]   |          assert_eq!(identity.provider_id, "github");
[CI/fmt ]   |          assert_eq!(identity.external_id, "123");
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:29:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      #[cfg(test)]
[CI/fmt ]   | -    pub(crate) fn with_test_urls(mut self, auth_url: String, token_url: String, userinfo_url: String, revoke_url: String) -> Self {
[CI/fmt ]   | +    pub(crate) fn with_test_urls(
[CI/fmt ]   | +        mut self,
[CI/fmt ]   | +        auth_url: String,
[CI/fmt ]   | +        token_url: String,
[CI/fmt ]   | +        userinfo_url: String,
[CI/fmt ]   | +        revoke_url: String,
[CI/fmt ]   | +    ) -> Self {
[CI/fmt ]   |          self.auth_url = auth_url;
[CI/fmt ]   |          self.token_url = token_url;
[CI/fmt ]   |          self.userinfo_url = userinfo_url;
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:60:
[CI/fmt ]   |  
[CI/fmt ]   |  #[async_trait]
[CI/fmt ]   |  impl OAuthProvider for GoogleProvider {
[CI/fmt ]   | -    fn get_authorization_url(&self, state: &str, scopes: &[&str], code_challenge: Option<&str>) -> String {
[CI/fmt ]   | +    fn get_authorization_url(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        state: &str,
[CI/fmt ]   | +        scopes: &[&str],
[CI/fmt ]   | +        code_challenge: Option<&str>,
[CI/fmt ]   | +    ) -> String {
[CI/fmt ]   |          let scope_param = if scopes.is_empty() {
[CI/fmt ]   |              "openid email profile".to_string()
[CI/fmt ]   |          } else {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:73:
[CI/fmt ]   |          );
[CI/fmt ]   |  
[CI/fmt ]   |          if let Some(challenge) = code_challenge {
[CI/fmt ]   | -            url.push_str(&format!("&code_challenge={}&code_challenge_method=S256", challenge));
[CI/fmt ]   | +            url.push_str(&format!(
[CI/fmt ]   | +                "&code_challenge={}&code_challenge_method=S256",
[CI/fmt ]   | +                challenge
[CI/fmt ]   | +            ));
[CI/fmt ]   |          }
[CI/fmt ]   |  
[CI/fmt ]   |          url
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:80:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   | -    async fn exchange_code_for_identity(&self, code: &str, code_verifier: Option<&str>) -> Result<(Identity, OAuthToken), AuthError> {
[CI/fmt ]   | +    async fn exchange_code_for_identity(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        code: &str,
[CI/fmt ]   | +        code_verifier: Option<&str>,
[CI/fmt ]   | +    ) -> Result<(Identity, OAuthToken), AuthError> {
[CI/fmt ]   |          // 1. Exchange code for access token
[CI/fmt ]   |          let mut params = vec![
[CI/fmt ]   |              ("code", code.to_string()),
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:93:
[CI/fmt ]   |              params.push(("code_verifier", verifier.to_string()));
[CI/fmt ]   |          }
[CI/fmt ]   |  
[CI/fmt ]   | -        let token_response = self.http_client
[CI/fmt ]   | +        let token_response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .post(&self.token_url)
[CI/fmt ]   |              .form(&params)
[CI/fmt ]   |              .send()
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:104:
[CI/fmt ]   |              .map_err(|e| AuthError::Provider(format!("Failed to parse token response: {}", e)))?;
[CI/fmt ]   |  
[CI/fmt ]   |          // 2. Get user information
[CI/fmt ]   | -        let user_response = self.http_client
[CI/fmt ]   | +        let user_response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .get(&self.userinfo_url)
[CI/fmt ]   | -            .header("Authorization", format!("Bearer {}", token_response.access_token))
[CI/fmt ]   | +            .header(
[CI/fmt ]   | +                "Authorization",
[CI/fmt ]   | +                format!("Bearer {}", token_response.access_token),
[CI/fmt ]   | +            )
[CI/fmt ]   |              .send()
[CI/fmt ]   |              .await
[CI/fmt ]   |              .map_err(|_| AuthError::Network)?
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:147:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      async fn refresh_token(&self, refresh_token: &str) -> Result<OAuthToken, AuthError> {
[CI/fmt ]   | -        let token_response = self.http_client
[CI/fmt ]   | +        let token_response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .post(&self.token_url)
[CI/fmt ]   |              .form(&[
[CI/fmt ]   |                  ("refresh_token", refresh_token),
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:160:
[CI/fmt ]   |              .map_err(|_| AuthError::Network)?
[CI/fmt ]   |              .json::<GoogleTokenResponse>()
[CI/fmt ]   |              .await
[CI/fmt ]   | -            .map_err(|e| AuthError::Provider(format!("Failed to parse refresh token response: {}", e)))?;
[CI/fmt ]   | +            .map_err(|e| {
[CI/fmt ]   | +                AuthError::Provider(format!("Failed to parse refresh token response: {}", e))
[CI/fmt ]   | +            })?;
[CI/fmt ]   |  
[CI/fmt ]   |          Ok(OAuthToken {
[CI/fmt ]   |              access_token: token_response.access_token,
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:167:
[CI/fmt ]   |              token_type: token_response.token_type,
[CI/fmt ]   |              expires_in: token_response.expires_in,
[CI/fmt ]   | -            refresh_token: token_response.refresh_token.or_else(|| Some(refresh_token.to_string())),
[CI/fmt ]   | +            refresh_token: token_response
[CI/fmt ]   | +                .refresh_token
[CI/fmt ]   | +                .or_else(|| Some(refresh_token.to_string())),
[CI/fmt ]   |              scope: token_response.scope,
[CI/fmt ]   |              id_token: token_response.id_token,
[CI/fmt ]   |          })
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:173:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      async fn revoke_token(&self, token: &str) -> Result<(), AuthError> {
[CI/fmt ]   | -        let response = self.http_client
[CI/fmt ]   | +        let response = self
[CI/fmt ]   | +            .http_client
[CI/fmt ]   |              .post(&self.revoke_url)
[CI/fmt ]   |              .form(&[("token", token)])
[CI/fmt ]   |              .send()
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:183:
[CI/fmt ]   |          if response.status().is_success() {
[CI/fmt ]   |              Ok(())
[CI/fmt ]   |          } else {
[CI/fmt ]   | -            let error_text = response.text().await.unwrap_or_else(|_| "Unknown error".to_string());
[CI/fmt ]   | -            Err(AuthError::Provider(format!("Failed to revoke token: {}", error_text)))
[CI/fmt ]   | +            let error_text = response
[CI/fmt ]   | +                .text()
[CI/fmt ]   | +                .await
[CI/fmt ]   | +                .unwrap_or_else(|_| "Unknown error".to_string());
[CI/fmt ]   | +            Err(AuthError::Provider(format!(
[CI/fmt ]   | +                "Failed to revoke token: {}",
[CI/fmt ]   | +                error_text
[CI/fmt ]   | +            )))
[CI/fmt ]   |          }
[CI/fmt ]   |      }
[CI/fmt ]   |  }
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:208:
[CI/fmt ]   |              .create_async()
[CI/fmt ]   |              .await;
[CI/fmt ]   |  
[CI/fmt ]   | -        let _user_mock = server.mock("GET", "/userinfo")
[CI/fmt ]   | +        let _user_mock = server
[CI/fmt ]   | +            .mock("GET", "/userinfo")
[CI/fmt ]   |              .with_status(200)
[CI/fmt ]   |              .with_header("content-type", "application/json")
[CI/fmt ]   | -            .with_body(r#"{
[CI/fmt ]   | +            .with_body(
[CI/fmt ]   | +                r#"{
[CI/fmt ]   |                  "sub": "google-123",
[CI/fmt ]   |                  "email": "test@google.com",
[CI/fmt ]   |                  "name": "Google User",
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:218:
[CI/fmt ]   |                  "picture": "http://picture",
[CI/fmt ]   |                  "email_verified": true,
[CI/fmt ]   |                  "locale": "en"
[CI/fmt ]   | -            }"#)
[CI/fmt ]   | +            }"#,
[CI/fmt ]   | +            )
[CI/fmt ]   |              .create_async()
[CI/fmt ]   |              .await;
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:226:
[CI/fmt ]   |              "client_id".to_string(),
[CI/fmt ]   |              "client_secret".to_string(),
[CI/fmt ]   |              "http://localhost/callback".to_string(),
[CI/fmt ]   | -        ).with_test_urls(auth_url, token_url, userinfo_url, "http://localhost/revoke".to_string());
[CI/fmt ]   | +        )
[CI/fmt ]   | +        .with_test_urls(
[CI/fmt ]   | +            auth_url,
[CI/fmt ]   | +            token_url,
[CI/fmt ]   | +            userinfo_url,
[CI/fmt ]   | +            "http://localhost/revoke".to_string(),
[CI/fmt ]   | +        );
[CI/fmt ]   |  
[CI/fmt ]   | -        let (identity, token) = provider.exchange_code_for_identity("test_code", None).await.unwrap();
[CI/fmt ]   | +        let (identity, token) = provider
[CI/fmt ]   | +            .exchange_code_for_identity("test_code", None)
[CI/fmt ]   | +            .await
[CI/fmt ]   | +            .unwrap();
[CI/fmt ]   |  
[CI/fmt ]   |          assert_eq!(identity.provider_id, "google");
[CI/fmt ]   |          assert_eq!(identity.external_id, "google-123");
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-providers-google/src/lib.rs:235:
[CI/fmt ]   |          assert_eq!(identity.username, Some("Google User".to_string()));
[CI/fmt ]   |          assert_eq!(identity.email, Some("test@google.com".to_string()));
[CI/fmt ]   | -        assert_eq!(identity.attributes.get("picture").unwrap(), "http://picture");
[CI/fmt ]   | +        assert_eq!(
[CI/fmt ]   | +            identity.attributes.get("picture").unwrap(),
[CI/fmt ]   | +            "http://picture"
[CI/fmt ]   | +        );
[CI/fmt ]   |          assert_eq!(identity.attributes.get("email_verified").unwrap(), "true");
[CI/fmt ]   |          assert_eq!(identity.attributes.get("locale").unwrap(), "en");
[CI/fmt ]   |          assert_eq!(token.access_token, "test_token");
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-session/src/lib.rs:1:
[CI/fmt ]   |  use async_trait::async_trait;
[CI/fmt ]   | -use authly_core::{Identity, AuthError};
[CI/fmt ]   | +use authly_core::{AuthError, Identity};
[CI/fmt ]   |  use serde::{Deserialize, Serialize};
[CI/fmt ]   |  
[CI/fmt ]   |  use std::collections::HashMap;
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-session/src/lib.rs:11:
[CI/fmt ]   |  #[cfg(feature = "store-sqlx")]
[CI/fmt ]   |  pub use sql_store::{SqlSessionStore, SqlStore};
[CI/fmt ]   |  
[CI/fmt ]   | -
[CI/fmt ]   |  #[cfg(feature = "store-redis")]
[CI/fmt ]   |  pub mod redis_store;
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-session/src/lib.rs:18:
[CI/fmt ]   |  #[cfg(feature = "store-redis")]
[CI/fmt ]   |  pub use redis_store::RedisStore;
[CI/fmt ]   |  
[CI/fmt ]   | -
[CI/fmt ]   |  #[derive(Clone, Debug, Serialize, Deserialize)]
[CI/fmt ]   |  pub struct Session {
[CI/fmt ]   |      pub id: String,
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-session/src/lib.rs:50:
[CI/fmt ]   |          Ok(self.sessions.lock().unwrap().get(id).cloned())
[CI/fmt ]   |      }
[CI/fmt ]   |      async fn save_session(&self, session: &Session) -> Result<(), AuthError> {
[CI/fmt ]   | -        self.sessions.lock().unwrap().insert(session.id.clone(), session.clone());
[CI/fmt ]   | +        self.sessions
[CI/fmt ]   | +            .lock()
[CI/fmt ]   | +            .unwrap()
[CI/fmt ]   | +            .insert(session.id.clone(), session.clone());
[CI/fmt ]   |          Ok(())
[CI/fmt ]   |      }
[CI/fmt ]   |      async fn delete_session(&self, id: &str) -> Result<(), AuthError> {
[CI/test]   |   Downloaded tracing v0.1.44
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-session/src/sql_store.rs:1:
[CI/fmt ]   | -use authly_core::{AuthError, Identity};
[CI/fmt ]   |  use crate::{Session, SessionStore};
[CI/fmt ]   |  use async_trait::async_trait;
[CI/fmt ]   | +use authly_core::{AuthError, Identity};
[CI/fmt ]   |  use sqlx::Database;
[CI/fmt ]   |  use std::collections::HashMap;
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-session/src/sql_store.rs:46:
[CI/fmt ]   |              self.table_name
[CI/fmt ]   |          );
[CI/fmt ]   |          let now = chrono::Utc::now();
[CI/fmt ]   | -        
[CI/fmt ]   | +
[CI/fmt ]   |          let row: Option<SqlSessionModel> = sqlx::query_as(&query)
[CI/fmt ]   |              .bind(id)
[CI/fmt ]   |              .bind(now)
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-session/src/sql_store.rs:56:
[CI/fmt ]   |  
[CI/fmt ]   |          match row {
[CI/fmt ]   |              Some(model) => {
[CI/fmt ]   | -                let claims: HashMap<String, String> = serde_json::from_str(&model.claims)
[CI/fmt ]   | -                    .map_err(|e| AuthError::Session(format!("Claims deserialization error: {}", e)))?;
[CI/fmt ]   | -                
[CI/fmt ]   | +                let claims: HashMap<String, String> =
[CI/fmt ]   | +                    serde_json::from_str(&model.claims).map_err(|e| {
[CI/fmt ]   | +                        AuthError::Session(format!("Claims deserialization error: {}", e))
[CI/fmt ]   | +                    })?;
[CI/fmt ]   | +
[CI/fmt ]   |                  let session = Session {
[CI/fmt ]   |                      id: model.id,
[CI/fmt ]   |                      identity: Identity {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-session/src/sql_store.rs:122:
[CI/fmt ]   |              self.table_name
[CI/fmt ]   |          );
[CI/fmt ]   |          let now = chrono::Utc::now();
[CI/fmt ]   | -        
[CI/fmt ]   | +
[CI/fmt ]   |          let row: Option<SqlSessionModel> = sqlx::query_as(&query)
[CI/fmt ]   |              .bind(id)
[CI/fmt ]   |              .bind(now)
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-session/src/sql_store.rs:132:
[CI/fmt ]   |  
[CI/fmt ]   |          match row {
[CI/fmt ]   |              Some(model) => {
[CI/fmt ]   | -                let claims: HashMap<String, String> = serde_json::from_str(&model.claims)
[CI/fmt ]   | -                    .map_err(|e| AuthError::Session(format!("Claims deserialization error: {}", e)))?;
[CI/fmt ]   | -                
[CI/fmt ]   | +                let claims: HashMap<String, String> =
[CI/fmt ]   | +                    serde_json::from_str(&model.claims).map_err(|e| {
[CI/fmt ]   | +                        AuthError::Session(format!("Claims deserialization error: {}", e))
[CI/fmt ]   | +                    })?;
[CI/fmt ]   | +
[CI/fmt ]   |                  let session = Session {
[CI/fmt ]   |                      id: model.id,
[CI/fmt ]   |                      identity: Identity {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-session/src/sql_store.rs:198:
[CI/fmt ]   |              self.table_name
[CI/fmt ]   |          );
[CI/fmt ]   |          let now = chrono::Utc::now();
[CI/fmt ]   | -        
[CI/fmt ]   | +
[CI/fmt ]   |          let row: Option<SqlSessionModel> = sqlx::query_as(&query)
[CI/fmt ]   |              .bind(id)
[CI/fmt ]   |              .bind(now)
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-session/src/sql_store.rs:208:
[CI/fmt ]   |  
[CI/fmt ]   |          match row {
[CI/fmt ]   |              Some(model) => {
[CI/fmt ]   | -                let claims: HashMap<String, String> = serde_json::from_str(&model.claims)
[CI/fmt ]   | -                    .map_err(|e| AuthError::Session(format!("Claims deserialization error: {}", e)))?;
[CI/fmt ]   | -                
[CI/fmt ]   | +                let claims: HashMap<String, String> =
[CI/fmt ]   | +                    serde_json::from_str(&model.claims).map_err(|e| {
[CI/fmt ]   | +                        AuthError::Session(format!("Claims deserialization error: {}", e))
[CI/fmt ]   | +                    })?;
[CI/fmt ]   | +
[CI/fmt ]   |                  let session = Session {
[CI/fmt ]   |                      id: model.id,
[CI/fmt ]   |                      identity: Identity {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-token/src/lib.rs:1:
[CI/fmt ]   | -use authly_core::{Identity, AuthError};
[CI/fmt ]   | +use authly_core::{AuthError, Identity};
[CI/fmt ]   | +use jsonwebtoken::{decode, encode, Algorithm, DecodingKey, EncodingKey, Header, Validation};
[CI/fmt ]   |  use serde::{Deserialize, Serialize};
[CI/fmt ]   | -use jsonwebtoken::{encode, decode, Header, Algorithm, Validation, EncodingKey, DecodingKey};
[CI/fmt ]   |  use std::collections::HashMap;
[CI/fmt ]   |  
[CI/fmt ]   |  #[derive(Debug, Serialize, Deserialize)]
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-token/src/lib.rs:36:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      /// Issues a token for a user identity.
[CI/fmt ]   | -    pub fn issue_user_token(&self, identity: Identity, expires_in_secs: u64, scope: Option<String>) -> Result<String, AuthError> {
[CI/fmt ]   | +    pub fn issue_user_token(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        identity: Identity,
[CI/fmt ]   | +        expires_in_secs: u64,
[CI/fmt ]   | +        scope: Option<String>,
[CI/fmt ]   | +    ) -> Result<String, AuthError> {
[CI/fmt ]   |          let now = chrono::Utc::now().timestamp() as usize;
[CI/fmt ]   |          let expiration = now + expires_in_secs as usize;
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-token/src/lib.rs:56:
[CI/fmt ]   |      }
[CI/fmt ]   |  
[CI/fmt ]   |      /// Issues a machine-to-machine (M2M) token for a client.
[CI/fmt ]   | -    pub fn issue_client_token(&self, client_id: &str, expires_in_secs: u64, scope: Option<String>) -> Result<String, AuthError> {
[CI/fmt ]   | +    pub fn issue_client_token(
[CI/fmt ]   | +        &self,
[CI/fmt ]   | +        client_id: &str,
[CI/fmt ]   | +        expires_in_secs: u64,
[CI/fmt ]   | +        scope: Option<String>,
[CI/fmt ]   | +    ) -> Result<String, AuthError> {
[CI/fmt ]   |          let now = chrono::Utc::now().timestamp() as usize;
[CI/fmt ]   |          let expiration = now + expires_in_secs as usize;
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/authly-token/src/lib.rs:81:
[CI/fmt ]   |              validation.set_issuer(&[iss]);
[CI/fmt ]   |          }
[CI/fmt ]   |  
[CI/fmt ]   | -        let token_data = decode::<Claims>(
[CI/fmt ]   | -            token,
[CI/fmt ]   | -            &self.decoding_key,
[CI/fmt ]   | -            &validation,
[CI/fmt ]   | -        ).map_err(|e| AuthError::Token(e.to_string()))?;
[CI/fmt ]   | +        let token_data = decode::<Claims>(token, &self.decoding_key, &validation)
[CI/fmt ]   | +            .map_err(|e| AuthError::Token(e.to_string()))?;
[CI/fmt ]   |  
[CI/fmt ]   |          Ok(token_data.claims)
[CI/fmt ]   |      }
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_credentials.rs:63:
[CI/fmt ]   |          // Mocking SQLx query
[CI/fmt ]   |          // let user = sqlx::query_as!(LocalUser, "SELECT id, username, role FROM users WHERE external_id = $1", identity.external_id)
[CI/fmt ]   |          //     .fetch_one(&self.pool).await?;
[CI/fmt ]   | -        
[CI/fmt ]   | +
[CI/fmt ]   |          println!("Mapping identity {} to local user", identity.external_id);
[CI/fmt ]   | -        
[CI/fmt ]   | +
[CI/fmt ]   |          Ok(LocalUser {
[CI/fmt ]   |              id: 1,
[CI/fmt ]   |              username: identity.username.clone().unwrap_or_default(),
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_credentials.rs:99:
[CI/fmt ]   |      let provider = MyCredentialsProvider;
[CI/fmt ]   |      let mapper = SqlxUserMapper {};
[CI/fmt ]   |      let auth_flow = Arc::new(CredentialsFlow::with_mapper(provider, mapper));
[CI/fmt ]   | -    
[CI/fmt ]   | +
[CI/fmt ]   |      let session_store = Arc::new(authly_session::MemoryStore::default());
[CI/fmt ]   |  
[CI/fmt ]   |      let state = AppState {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_credentials.rs:121:
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   |  async fn index() -> impl IntoResponse {
[CI/fmt ]   | -    axum::response::Html(r#"
[CI/fmt ]   | +    axum::response::Html(
[CI/fmt ]   | +        r#"
[CI/fmt ]   |          <form action="/login" method="post">
[CI/fmt ]   |              <input type="text" name="username" placeholder="Username" />
[CI/fmt ]   |              <input type="password" name="password" placeholder="Password" />
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_credentials.rs:128:
[CI/fmt ]   |              <button type="submit">Login</button>
[CI/fmt ]   |          </form>
[CI/fmt ]   | -    "#)
[CI/fmt ]   | +    "#,
[CI/fmt ]   | +    )
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   |  async fn login(
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_credentials.rs:135:
[CI/fmt ]   |      cookies: Cookies,
[CI/fmt ]   |      Form(creds): Form<LoginCredentials>,
[CI/fmt ]   |  ) -> Result<impl IntoResponse, (axum::http::StatusCode, String)> {
[CI/fmt ]   | -    let (identity, local_user) = state.auth_flow.authenticate(creds).await
[CI/fmt ]   | +    let (identity, local_user) = state
[CI/fmt ]   | +        .auth_flow
[CI/fmt ]   | +        .authenticate(creds)
[CI/fmt ]   | +        .await
[CI/fmt ]   |          .map_err(|e| (axum::http::StatusCode::UNAUTHORIZED, e.to_string()))?;
[CI/fmt ]   |  
[CI/fmt ]   |      // local_user is Some(LocalUser { ... }) because we used with_mapper
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_credentials.rs:149:
[CI/fmt ]   |          expires_at: chrono::Utc::now() + chrono::Duration::hours(24),
[CI/fmt ]   |      };
[CI/fmt ]   |  
[CI/fmt ]   | -    state.session_store.save_session(&session).await
[CI/fmt ]   | +    state
[CI/fmt ]   | +        .session_store
[CI/fmt ]   | +        .save_session(&session)
[CI/fmt ]   | +        .await
[CI/fmt ]   |          .map_err(|e| (axum::http::StatusCode::INTERNAL_SERVER_ERROR, e.to_string()))?;
[CI/fmt ]   |  
[CI/fmt ]   |      let cookie = state.session_config.create_cookie(session.id);
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_credentials.rs:159:
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   |  async fn protected(AuthSession(session): AuthSession) -> impl IntoResponse {
[CI/fmt ]   | -    format!("Hello, {}! Your ID is {}. Session ID: {}", 
[CI/fmt ]   | -        session.identity.username.unwrap_or_default(), 
[CI/fmt ]   | +    format!(
[CI/fmt ]   | +        "Hello, {}! Your ID is {}. Session ID: {}",
[CI/fmt ]   | +        session.identity.username.unwrap_or_default(),
[CI/fmt ]   |          session.identity.external_id,
[CI/fmt ]   |          session.id
[CI/fmt ]   |      )
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_github.rs:1:
[CI/fmt ]   | -use authly_axum::{handle_oauth_callback_jwt, initiate_oauth_login, logout, AuthToken, OAuthCallbackParams, SessionConfig};
[CI/fmt ]   | +use authly_axum::{
[CI/fmt ]   | +    handle_oauth_callback_jwt, initiate_oauth_login, logout, AuthToken, OAuthCallbackParams,
[CI/fmt ]   | +    SessionConfig,
[CI/fmt ]   | +};
[CI/fmt ]   |  use authly_flow::OAuth2Flow;
[CI/fmt ]   |  use authly_providers_github::GithubProvider;
[CI/fmt ]   | +use authly_session::{SessionStore, SqlStore};
[CI/fmt ]   |  use authly_token::TokenManager;
[CI/fmt ]   |  use axum::{
[CI/fmt ]   | -    extract::{Query, State, FromRef},
[CI/fmt ]   | +    extract::{FromRef, Query, State},
[CI/fmt ]   |      response::IntoResponse,
[CI/fmt ]   |      routing::get,
[CI/fmt ]   |      Router,
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_github.rs:10:
[CI/fmt ]   |  };
[CI/fmt ]   | -use authly_session::{SessionStore, SqlStore};
[CI/fmt ]   | -use std::sync::Arc;
[CI/fmt ]   | -use tower_cookies::{Cookies, CookieManagerLayer};
[CI/fmt ]   |  use sqlx::sqlite::SqlitePool;
[CI/fmt ]   | +use std::sync::Arc;
[CI/fmt ]   | +use tower_cookies::{CookieManagerLayer, Cookies};
[CI/fmt ]   |  
[CI/fmt ]   |  #[derive(Clone)]
[CI/fmt ]   |  struct AppState {
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_github.rs:30:
[CI/fmt ]   |  async fn main() {
[CI/fmt ]   |      dotenvy::dotenv().ok();
[CI/fmt ]   |  
[CI/fmt ]   | -    let client_id = std::env::var("AUTHLY_GITHUB_CLIENT_ID")
[CI/fmt ]   | -        .expect("AUTHLY_GITHUB_CLIENT_ID must be set");
[CI/fmt ]   | +    let client_id =
[CI/fmt ]   | +        std::env::var("AUTHLY_GITHUB_CLIENT_ID").expect("AUTHLY_GITHUB_CLIENT_ID must be set");
[CI/fmt ]   |      let client_secret = std::env::var("AUTHLY_GITHUB_CLIENT_SECRET")
[CI/fmt ]   |          .expect("AUTHLY_GITHUB_CLIENT_SECRET must be set");
[CI/fmt ]   |      let redirect_uri = std::env::var("AUTHLY_GITHUB_REDIRECT_URI")
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_github.rs:39:
[CI/fmt ]   |      let jwt_secret = std::env::var("AUTHLY_JWT_SECRET")
[CI/fmt ]   |          .unwrap_or_else(|_| "super-secret-key-change-me-in-production".to_string());
[CI/fmt ]   |  
[CI/fmt ]   | -    let provider = GithubProvider::new(
[CI/fmt ]   | -        client_id,
[CI/fmt ]   | -        client_secret,
[CI/fmt ]   | -        redirect_uri,
[CI/fmt ]   | -    );
[CI/fmt ]   | +    let provider = GithubProvider::new(client_id, client_secret, redirect_uri);
[CI/fmt ]   |      let github_flow = Arc::new(OAuth2Flow::new(provider));
[CI/fmt ]   | -    let token_manager = Arc::new(TokenManager::new(jwt_secret.as_bytes(), Some("authly-rs".to_string())));
[CI/fmt ]   | +    let token_manager = Arc::new(TokenManager::new(
[CI/fmt ]   | +        jwt_secret.as_bytes(),
[CI/fmt ]   | +        Some("authly-rs".to_string()),
[CI/fmt ]   | +    ));
[CI/fmt ]   |      // For this example, we'll use SQLite for session persistence.
[CI/fmt ]   |      let db_url = "sqlite::memory:";
[CI/fmt ]   | -    let pool = SqlitePool::connect(db_url).await.expect("Failed to connect to SQLite");
[CI/fmt ]   | -    
[CI/fmt ]   | +    let pool = SqlitePool::connect(db_url)
[CI/fmt ]   | +        .await
[CI/fmt ]   | +        .expect("Failed to connect to SQLite");
[CI/fmt ]   | +
[CI/fmt ]   |      // Initialize the sessions table
[CI/fmt ]   |      sqlx::query(
[CI/fmt ]   |          "CREATE TABLE IF NOT EXISTS authly_sessions (
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_github.rs:60:
[CI/fmt ]   |              name VARCHAR(255),
[CI/fmt ]   |              claims TEXT NOT NULL,
[CI/fmt ]   |              expires_at TIMESTAMP NOT NULL
[CI/fmt ]   | -        )"
[CI/fmt ]   | +        )",
[CI/fmt ]   |      )
[CI/fmt ]   |      .execute(&pool)
[CI/fmt ]   |      .await
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_github.rs:92:
[CI/fmt ]   |      "Welcome! Go to /auth/github to login (Stateless JWT mode)."
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   | -async fn github_login(
[CI/fmt ]   | -    State(state): State<AppState>,
[CI/fmt ]   | -    cookies: Cookies,
[CI/fmt ]   | -) -> impl IntoResponse {
[CI/fmt ]   | +async fn github_login(State(state): State<AppState>, cookies: Cookies) -> impl IntoResponse {
[CI/fmt ]   |      initiate_oauth_login(&state.github_flow, &cookies, &["user:email"])
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_github.rs:114:
[CI/fmt ]   |      .await
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   | -async fn github_logout(
[CI/fmt ]   | -    State(state): State<AppState>,
[CI/fmt ]   | -    cookies: Cookies,
[CI/fmt ]   | -) -> impl IntoResponse {
[CI/fmt ]   | +async fn github_logout(State(state): State<AppState>, cookies: Cookies) -> impl IntoResponse {
[CI/fmt ]   |      logout(cookies, state.session_store, SessionConfig::default(), "/").await
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_github.rs:124:
[CI/fmt ]   |  async fn protected(AuthToken(claims): AuthToken) -> impl IntoResponse {
[CI/fmt ]   | -    let name = claims.identity.as_ref().and_then(|i| i.username.clone()).unwrap_or_else(|| "Unknown".to_string());
[CI/fmt ]   | +    let name = claims
[CI/fmt ]   | +        .identity
[CI/fmt ]   | +        .as_ref()
[CI/fmt ]   | +        .and_then(|i| i.username.clone())
[CI/fmt ]   | +        .unwrap_or_else(|| "Unknown".to_string());
[CI/fmt ]   |      format!(
[CI/fmt ]   |          "Hello, {}! Your ID is {}. You are authenticated via the new AuthToken extractor.",
[CI/fmt ]   | -        name,
[CI/fmt ]   | -        claims.sub
[CI/fmt ]   | +        name, claims.sub
[CI/fmt ]   |      )
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/axum_google.rs:80:
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   |  async fn google_login(State(state): State<AppState>, cookies: Cookies) -> impl IntoResponse {
[CI/fmt ]   | -    initiate_oauth_login(&state.google_flow, &cookies, &["openid", "email", "profile"])
[CI/fmt ]   | +    initiate_oauth_login(
[CI/fmt ]   | +        &state.google_flow,
[CI/fmt ]   | +        &cookies,
[CI/fmt ]   | +        &["openid", "email", "profile"],
[CI/fmt ]   | +    )
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   |  async fn google_callback(
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/oidc_generic.rs:39:
[CI/fmt ]   |  
[CI/fmt ]   |      let issuer = std::env::var("OIDC_ISSUER").expect("OIDC_ISSUER must be set");
[CI/fmt ]   |      let client_id = std::env::var("OIDC_CLIENT_ID").expect("OIDC_CLIENT_ID must be set");
[CI/fmt ]   | -    let client_secret = std::env::var("OIDC_CLIENT_SECRET").expect("OIDC_CLIENT_SECRET must be set");
[CI/fmt ]   | +    let client_secret =
[CI/fmt ]   | +        std::env::var("OIDC_CLIENT_SECRET").expect("OIDC_CLIENT_SECRET must be set");
[CI/fmt ]   |      let redirect_uri = std::env::var("OIDC_REDIRECT_URI")
[CI/fmt ]   |          .unwrap_or_else(|_| "http://localhost:3000/auth/oidc/callback".to_string());
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/oidc_generic.rs:46:
[CI/fmt ]   |      println!("Initializing OIDC provider with issuer: {}", issuer);
[CI/fmt ]   | -    
[CI/fmt ]   | +
[CI/fmt ]   |      // Demonstrate initialization/discovery
[CI/fmt ]   |      let provider = OidcProvider::discover(client_id, client_secret, redirect_uri, &issuer).await?;
[CI/fmt ]   |      let oidc_flow = Arc::new(OAuth2Flow::new(provider));
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/oidc_generic.rs:75:
[CI/fmt ]   |      let listener = tokio::net::TcpListener::bind("0.0.0.0:3000").await.unwrap();
[CI/fmt ]   |      println!("Listening on http://0.0.0.0:3000");
[CI/fmt ]   |      axum::serve(listener, app).await.unwrap();
[CI/fmt ]   | -    
[CI/fmt ]   | +
[CI/fmt ]   |      Ok(())
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/oidc_generic.rs:87:
[CI/fmt ]   |      // Note: Some providers have specific scope requirements.
[CI/fmt ]   |      // For example, Discord does not support the standard 'profile' scope and requires 'identify' instead.
[CI/fmt ]   |      // If using Discord OIDC, you should use: &["openid", "email", "identify"]
[CI/fmt ]   | -    let scopes = std::env::var("OIDC_SCOPES")
[CI/fmt ]   | -        .unwrap_or_else(|_| "openid email profile".to_string());
[CI/fmt ]   | +    let scopes =
[CI/fmt ]   | +        std::env::var("OIDC_SCOPES").unwrap_or_else(|_| "openid email profile".to_string());
[CI/fmt ]   |      let scope_list: Vec<&str> = scopes.split_whitespace().collect();
[CI/fmt ]   | -    
[CI/fmt ]   | +
[CI/fmt ]   |      initiate_oauth_login(&state.oidc_flow, &cookies, &scope_list)
[CI/fmt ]   |  }
[CI/fmt ]   |  
[CI/fmt ]   | Diff in /home/marco/Projects/authly-rs/examples/oidc_generic.rs:112:
[CI/fmt ]   |  
[CI/fmt ]   |  async fn protected(AuthSession(session): AuthSession) -> impl IntoResponse {
[CI/fmt ]   |      println!("Identity verified: {:?}", session.identity);
[CI/fmt ]   | -    
[CI/fmt ]   | +
[CI/fmt ]   |      format!(
[CI/fmt ]   |          "Hello, {}! Your ID is {}. Your email is {:?}. Attributes: {:?}",
[CI/fmt ]   |          session.identity.username.unwrap_or_default(),
[CI/fmt ]   ‚ùå  Failure - Main Check formatting
[CI/test]   |   Downloaded socket2 v0.5.10
[CI/test]   |   Downloaded sqlx-mysql v0.8.6
[CI/fmt ] exitcode '1': failure
[CI/test]   |   Downloaded socket2 v0.6.2
[CI/test]   |   Downloaded serde v1.0.228
[CI/test]   |   Downloaded sqlx-sqlite v0.8.6
[CI/test]   |   Downloaded url v2.5.8
[CI/fmt ] ‚≠ê Run Complete job
[CI/test]   |   Downloaded sqlx-core v0.8.6
[CI/fmt ]   ‚úÖ  Success - Complete job
[CI/fmt ] üèÅ  Job failed
[CI/test]   |   Downloaded num-bigint-dig v0.8.6
[CI/test]   |   Downloaded regex v1.12.2
[CI/test]   |   Downloaded sqlx-postgres v0.8.6
[CI/test]   |   Downloaded sqlx v0.8.6
[CI/test]   |   Downloaded rustls-webpki v0.101.7
[CI/test]   |   Downloaded reqwest v0.11.27
[CI/test]   |   Downloaded mio v1.1.1
[CI/test]   |   Downloaded num-bigint v0.4.6
[CI/test]   |   Downloaded rustls v0.21.12
[CI/test]   |   Downloaded libc v0.2.180
[CI/test]   |   Downloaded syn v2.0.114
[CI/test]   |   Downloaded openssl v0.10.75
[CI/test]   |   Downloaded regex-syntax v0.8.8
[CI/test]   |   Downloaded rustls-webpki v0.103.9
[CI/test]   |   Downloaded rsa v0.9.10
[CI/test]   |   Downloaded rustls v0.23.36
[CI/test]   |   Downloaded rand v0.9.2
[CI/test]   |   Downloaded openssl-sys v0.9.111
[CI/test]   |   Downloaded similar v2.7.0
[CI/test]   |   Downloaded serde_derive v1.0.228
[CI/test]   |   Downloaded serde_core v1.0.228
[CI/test]   |   Downloaded ryu v1.0.22
[CI/test]   |   Downloaded proc-macro2 v1.0.106
[CI/test]   |   Downloaded parking_lot v0.12.5
[CI/test]   |   Downloaded tokio-rustls v0.24.1
[CI/test]   |   Downloaded tinystr v0.8.2
[CI/test]   |   Downloaded redis v0.25.4
[CI/test]   |   Downloaded regex-automata v0.4.13
[CI/test]   |   Downloaded rustls-pemfile v1.0.4
[CI/test]   |   Downloaded serde_path_to_error v0.1.20
[CI/test]   |   Downloaded rand_core v0.9.5
[CI/test]   |   Downloaded thiserror-impl v1.0.69
[CI/test]   |   Downloaded thiserror v1.0.69
[CI/test]   |   Downloaded subtle v2.6.1
[CI/test]   |   Downloaded spki v0.7.3
[CI/lint]   ‚ùì  ::group::Cache Configuration
[CI/lint]   | Cache Provider:
[CI/lint]   |     github
[CI/lint]   | Workspaces:
[CI/lint]   |     /home/marco/Projects/authly-rs
[CI/lint]   | Cache Paths:
[CI/lint]   |     /root/.cargo/bin
[CI/lint]   |     /root/.cargo/.crates.toml
[CI/lint]   |     /root/.cargo/.crates2.json
[CI/lint]   |     /root/.cargo/registry
[CI/lint]   |     /root/.cargo/git
[CI/lint]   |     /home/marco/Projects/authly-rs/target
[CI/lint]   | Restore Key:
[CI/lint]   |     v0-rust-lint-Linux-x64-ac03b981
[CI/lint]   | Cache Key:
[CI/lint]   |     v0-rust-lint-Linux-x64-ac03b981-69518b37
[CI/lint]   | .. Prefix:
[CI/lint]   |   - v0-rust-lint-Linux-x64
[CI/lint]   | .. Environment considered:
[CI/lint]   |   - Rust Version: 1.93.0 x86_64-unknown-linux-gnu (254b59607d4417e9dffbc307138ae5c86280fe4c)
[CI/lint]   |   - CARGO_INCREMENTAL
[CI/lint]   | .. Lockfiles considered:
[CI/lint]   |   - /home/marco/Projects/authly-rs/authly-axum/Cargo.toml
[CI/lint]   |   - /home/marco/Projects/authly-rs/authly-core/Cargo.toml
[CI/lint]   |   - /home/marco/Projects/authly-rs/authly-flow/Cargo.toml
[CI/lint]   |   - /home/marco/Projects/authly-rs/authly-oidc/Cargo.toml
[CI/lint]   |   - /home/marco/Projects/authly-rs/authly-providers-discord/Cargo.toml
[CI/lint]   |   - /home/marco/Projects/authly-rs/authly-providers-github/Cargo.toml
[CI/lint]   |   - /home/marco/Projects/authly-rs/authly-providers-google/Cargo.toml
[CI/lint]   |   - /home/marco/Projects/authly-rs/authly-session/Cargo.toml
[CI/lint]   |   - /home/marco/Projects/authly-rs/authly-token/Cargo.toml
[CI/lint]   |   - /home/marco/Projects/authly-rs/Cargo.lock
[CI/lint]   ‚ùì  ::endgroup::
[CI/lint]   | 
[CI/lint]   | ... Restoring cache ...
[CI/test]   |   Downloaded shlex v1.3.0
[CI/test]   |   Downloaded sct v0.7.1
[CI/test]   |   Downloaded once_cell v1.21.3
[CI/test]   |   Downloaded vcpkg v0.2.15
[CI/lint]   | No cache found.
[CI/lint]   ‚úÖ  Success - Main Cache cargo registry and build
[CI/lint]   ‚öô  ::set-env:: CACHE_ON_FAILURE=false
[CI/lint]   ‚öô  ::set-env:: CARGO_INCREMENTAL=0
[CI/lint]   ‚öô  ::set-output:: cache-hit=false
[CI/lint] ‚≠ê Run Main Run clippy
[CI/lint]   üê≥  docker exec cmd=[bash -e /var/run/act/workflow/3] user= workdir=
[CI/test]   |   Downloaded tokio v1.49.0
[CI/test]   |   Downloaded multer v3.1.0
[CI/test]   |   Downloaded mockito v1.7.1
[CI/test]   |   Downloaded encoding_rs v0.8.35
[CI/test]   |   Downloaded chrono v0.4.43
[CI/test]   |   Downloaded utf8_iter v1.0.4
[CI/test]   |   Downloaded slab v0.4.11
[CI/test]   |   Downloaded rustversion v1.0.22
[CI/test]   |   Downloaded rand_core v0.6.4
[CI/test]   |   Downloaded matchit v0.7.3
[CI/test]   |   Downloaded time v0.3.45
[CI/test]   |   Downloaded litemap v0.8.1
[CI/test]   |   Downloaded hyper v1.8.1
[CI/test]   |   Downloaded hyper v0.14.32
[CI/test]   |   Downloaded hkdf v0.12.4
[CI/test]   |   Downloaded h2 v0.4.13
[CI/test]   |   Downloaded h2 v0.3.27
[CI/test]   |   Downloaded futures-util v0.3.31
[CI/lint]   |     Updating crates.io index
[CI/test]   |   Downloaded axum v0.7.9
[CI/test]   |   Downloaded rand v0.8.5
[CI/test]   |   Downloaded libm v0.2.16
[CI/test]   |   Downloaded aho-corasick v1.1.4
[CI/test]   |   Downloaded hashbrown v0.15.5
[CI/test]   |   Downloaded combine v4.6.7
[CI/test]   |   Downloaded sha1 v0.10.6
[CI/test]   |   Downloaded serde_urlencoded v0.7.1
[CI/test]   |   Downloaded hashbrown v0.16.1
[CI/test]   |   Downloaded idna v1.1.0
[CI/test]   |   Downloaded thiserror v2.0.18
[CI/test]   |   Downloaded stable_deref_trait v1.2.1
[CI/test]   |   Downloaded quote v1.0.44
[CI/test]   |   Downloaded pin-project-lite v0.2.16
[CI/test]   |   Downloaded parking v2.2.1
[CI/test]   |   Downloaded tower v0.5.3
[CI/test]   |   Downloaded rand_chacha v0.9.0
[CI/test]   |   Downloaded indexmap v2.13.0
[CI/test]   |   Downloaded hyper-util v0.1.19
[CI/test]   |   Downloaded tracing-core v0.1.36
[CI/test]   |   Downloaded md-5 v0.10.6
[CI/test]   |   Downloaded futures-intrusive v0.5.0
[CI/test]   |   Downloaded sync_wrapper v1.0.2
[CI/test]   |   Downloaded signature v2.2.0
[CI/test]   |   Downloaded http v1.4.0
[CI/test]   |   Downloaded http v0.2.12
[CI/test]   |   Downloaded cc v1.2.54
[CI/test]   |   Downloaded base64 v0.21.7
[CI/test]   |   Downloaded untrusted v0.9.0
[CI/test]   |   Downloaded unicode-properties v0.1.4
[CI/test]   |   Downloaded unicode-ident v1.0.22
[CI/test]   |   Downloaded tracing-attributes v0.1.31
[CI/test]   |   Downloaded der v0.7.10
[CI/test]   |   Downloaded ring v0.17.14
[CI/test]   |   Downloaded potential_utf v0.1.4
[CI/test]   |   Downloaded icu_normalizer v2.1.1
[CI/test]   |   Downloaded writeable v0.6.2
[CI/test]   |   Downloaded tokio-stream v0.1.18
[CI/test]   |   Downloaded parking_lot_core v0.9.12
[CI/test]   |   Downloaded icu_collections v2.1.1
[CI/test]   |   Downloaded flume v0.11.1
[CI/test]   |   Downloaded icu_normalizer_data v2.1.1
[CI/test]   |   Downloaded percent-encoding v2.3.2
[CI/test]   |   Downloaded icu_provider v2.1.1
[CI/test]   |   Downloaded getrandom v0.3.4
[CI/test]   |   Downloaded version_check v0.9.5
[CI/test]   |   Downloaded tower-service v0.3.3
[CI/test]   |   Downloaded openssl-macros v0.1.1
[CI/test]   |   Downloaded const-oid v0.9.6
[CI/test]   |   Downloaded tokio-macros v2.6.0
[CI/test]   |   Downloaded time-macros v0.2.25
[CI/test]   |   Downloaded memchr v2.7.6
[CI/test]   |   Downloaded concurrent-queue v2.5.0
[CI/test]   |   Downloaded crossbeam-utils v0.8.21
[CI/test]   |   Downloaded colored v3.1.1
[CI/test]   |   Downloaded hmac v0.12.1
[CI/test]   |   Downloaded tinyvec_macros v0.1.1
[CI/test]   |   Downloaded pkg-config v0.3.32
[CI/test]   |   Downloaded pkcs8 v0.10.2
[CI/test]   |   Downloaded pem-rfc7468 v0.7.0
[CI/test]   |   Downloaded native-tls v0.2.14
[CI/test]   |   Downloaded hyper-rustls v0.24.2
[CI/test]   |   Downloaded base64 v0.22.1
[CI/test]   |   Downloaded getrandom v0.2.17
[CI/test]   |   Downloaded event-listener v5.4.1
[CI/test]   |   Downloaded byteorder v1.5.0
[CI/test]   |   Downloaded pin-utils v0.1.0
[CI/test]   |   Downloaded num-conv v0.1.0
[CI/test]   |   Downloaded hashlink v0.10.0
[CI/test]   |   Downloaded either v1.15.0
[CI/test]   |   Downloaded digest v0.10.7
[CI/test]   |   Downloaded deranged v0.5.5
[CI/test]   |   Downloaded icu_properties v2.1.2
[CI/test]   |   Downloaded futures-task v0.3.31
[CI/test]   |   Downloaded futures-channel v0.3.31
[CI/test]   |   Downloaded bitflags v2.10.0
[CI/test]   |   Downloaded itoa v1.0.17
[CI/test]   |   Downloaded http-body-util v0.1.3
[CI/test]   |   Downloaded hex v0.4.3
[CI/test]   |   Downloaded futures-executor v0.3.31
[CI/test]   |   Downloaded mime v0.3.17
[CI/test]   |   Downloaded lazy_static v1.5.0
[CI/test]   |   Downloaded home v0.5.12
[CI/test]   |   Downloaded crossbeam-queue v0.3.12
[CI/test]   |   Downloaded crc-catalog v2.4.0
[CI/test]   |   Downloaded hyper-tls v0.5.0
[CI/test]   |   Downloaded http-body v0.4.6
[CI/test]   |   Downloaded futures-io v0.3.31
[CI/test]   |   Downloaded foreign-types v0.3.2
[CI/test]   |   Downloaded sha2 v0.10.9
[CI/test]   |   Downloaded rustls-pki-types v1.13.2
[CI/test]   |   Downloaded fnv v1.0.7
[CI/test]   |   Downloaded errno v0.3.14
[CI/test]   |   Downloaded fastrand v2.3.0
[CI/test]   |   Downloaded cpufeatures v0.2.17
[CI/test]   |   Downloaded cookie v0.18.1
[CI/test]   |   Downloaded futures-sink v0.3.31
[CI/test]   |   Downloaded futures-macro v0.3.31
[CI/test]   |   Downloaded equivalent v1.0.2
[CI/test]   |   Downloaded cfg-if v1.0.4
[CI/test]   |   Downloaded sqlx-macros-core v0.8.6
[CI/test]   |   Downloaded scopeguard v1.2.0
[CI/test]   |   Downloaded pkcs1 v0.7.5
[CI/test]   |   Downloaded foldhash v0.1.5
[CI/test]   |   Downloaded find-msvc-tools v0.1.8
[CI/test]   |   Downloaded dotenvy v0.15.7
[CI/test]   |   Downloaded base64ct v1.8.3
[CI/test]   |   Downloaded axum-core v0.4.5
[CI/test]   |   Downloaded crc v3.4.0
[CI/test]   |   Downloaded assert-json-diff v2.0.2
[CI/test]   |   Downloaded crypto-common v0.1.7
[CI/test]   |   Downloaded block-buffer v0.10.4
[CI/test]   |   Downloaded axum-extra v0.9.6
[CI/test]   |   Downloaded async-trait v0.1.89
[CI/test]   |   Downloaded allocator-api2 v0.2.21
[CI/test]   |   Downloaded autocfg v1.5.0
[CI/test]   |   Downloaded atomic-waker v1.1.2
[CI/test]   |   Downloaded futures-core v0.3.31
[CI/test]   |   Downloaded foreign-types-shared v0.1.1
[CI/test]   |   Downloaded jsonwebtoken v9.3.1
[CI/test]   |   Downloaded libsqlite3-sys v0.30.1
[CI/test]   |    Compiling proc-macro2 v1.0.106
[CI/test]   |    Compiling unicode-ident v1.0.22
[CI/test]   |    Compiling quote v1.0.44
[CI/test]   |    Compiling libc v0.2.180
[CI/test]   |    Compiling cfg-if v1.0.4
[CI/test]   |    Compiling shlex v1.3.0
[CI/test]   |    Compiling find-msvc-tools v0.1.8
[CI/test]   |    Compiling pin-project-lite v0.2.16
[CI/test]   |    Compiling futures-core v0.3.31
[CI/test]   |    Compiling itoa v1.0.17
[CI/test]   |    Compiling scopeguard v1.2.0
[CI/test]   |    Compiling bytes v1.11.0
[CI/test]   |    Compiling memchr v2.7.6
[CI/test]   |    Compiling parking_lot_core v0.9.12
[CI/test]   |    Compiling version_check v0.9.5
[CI/test]   |    Compiling smallvec v1.15.1
[CI/test]   |    Compiling serde_core v1.0.228
[CI/test]   |    Compiling autocfg v1.5.0
[CI/test]   |    Compiling lock_api v0.4.14
[CI/test]   |    Compiling once_cell v1.21.3
[CI/test]   |    Compiling cc v1.2.54
[CI/test]   |    Compiling slab v0.4.11
[CI/test]   |    Compiling serde v1.0.228
[CI/test]   |    Compiling pin-utils v0.1.0
[CI/test]   |    Compiling log v0.4.29
[CI/test]   |    Compiling stable_deref_trait v1.2.1
[CI/test]   |    Compiling futures-sink v0.3.31
[CI/test]   |    Compiling futures-io v0.3.31
[CI/test]   |    Compiling futures-task v0.3.31
[CI/test]   |    Compiling untrusted v0.9.0
[CI/test]   |    Compiling typenum v1.19.0
[CI/test]   |    Compiling tracing-core v0.1.36
[CI/test]   |    Compiling equivalent v1.0.2
[CI/test]   |    Compiling generic-array v0.14.7
[CI/test]   |    Compiling writeable v0.6.2
[CI/test]   |    Compiling litemap v0.8.1
[CI/test]   |    Compiling zmij v1.0.16
[CI/test]   |    Compiling hashbrown v0.16.1
[CI/test]   |    Compiling icu_normalizer_data v2.1.1
[CI/test]   |    Compiling serde_json v1.0.149
[CI/lint]   |  Downloading crates ...
[CI/test]   |    Compiling num-traits v0.2.19
[CI/test]   |    Compiling percent-encoding v2.3.2
[CI/test]   |    Compiling pkg-config v0.3.32
[CI/test]   |    Compiling vcpkg v0.2.15
[CI/test]   |    Compiling iana-time-zone v0.1.64
[CI/test]   |    Compiling icu_properties_data v2.1.2
[CI/lint]   |   Downloaded crc v3.4.0
[CI/lint]   |   Downloaded cfg-if v1.0.4
[CI/lint]   |   Downloaded openssl-macros v0.1.1
[CI/lint]   |   Downloaded cpufeatures v0.2.17
[CI/lint]   |   Downloaded num-iter v0.1.45
[CI/lint]   |   Downloaded num-conv v0.1.0
[CI/lint]   |   Downloaded slab v0.4.11
[CI/lint]   |   Downloaded time-core v0.1.7
[CI/lint]   |   Downloaded lock_api v0.4.14
[CI/lint]   |   Downloaded sha2 v0.10.9
[CI/lint]   |   Downloaded parking_lot v0.12.5
[CI/lint]   |   Downloaded mio v1.1.1
[CI/lint]   |   Downloaded tower-cookies v0.10.0
[CI/lint]   |   Downloaded tracing-core v0.1.36
[CI/lint]   |   Downloaded futures-macro v0.3.31
[CI/lint]   |   Downloaded try-lock v0.2.5
[CI/lint]   |   Downloaded unicode-bidi v0.3.18
[CI/lint]   |   Downloaded whoami v1.6.1
[CI/lint]   |   Downloaded zeroize v1.8.2
[CI/lint]   |   Downloaded want v0.3.1
[CI/lint]   |   Downloaded yoke v0.8.1
[CI/lint]   |   Downloaded tinyvec_macros v0.1.1
[CI/lint]   |   Downloaded sync_wrapper v0.1.2
[CI/test]   |    Compiling cpufeatures v0.2.17
[CI/lint]   |   Downloaded tracing-attributes v0.1.31
[CI/lint]   |   Downloaded webpki-roots v0.26.11
[CI/lint]   |   Downloaded unicode-properties v0.1.4
[CI/lint]   |   Downloaded utf8_iter v1.0.4
[CI/test]   |    Compiling zerocopy v0.8.33
[CI/lint]   |   Downloaded typenum v1.19.0
[CI/lint]   |   Downloaded zerofrom-derive v0.1.6
[CI/lint]   |   Downloaded unicode-normalization v0.1.25
[CI/lint]   |   Downloaded thiserror-impl v2.0.18
[CI/lint]   |   Downloaded webpki-roots v0.25.4
[CI/lint]   |   Downloaded tokio-native-tls v0.3.1
[CI/lint]   |   Downloaded pkcs8 v0.10.2
[CI/lint]   |   Downloaded tokio-macros v2.6.0
[CI/lint]   |   Downloaded quote v1.0.44
[CI/lint]   |   Downloaded pem-rfc7468 v0.7.0
[CI/lint]   |   Downloaded zerovec-derive v0.11.2
[CI/lint]   |   Downloaded tokio-stream v0.1.18
[CI/lint]   |   Downloaded tokio-rustls v0.24.1
[CI/lint]   |   Downloaded serde_core v1.0.228
[CI/lint]   |   Downloaded ryu v1.0.22
[CI/lint]   |   Downloaded zmij v1.0.16
[CI/lint]   |   Downloaded socket2 v0.6.2
[CI/lint]   |   Downloaded rand v0.8.5
[CI/test]   |    Compiling form_urlencoded v1.2.2
[CI/lint]   |   Downloaded sqlx-mysql v0.8.6
[CI/lint]   |   Downloaded openssl-sys v0.9.111
[CI/lint]   |   Downloaded serde_json v1.0.149
[CI/lint]   |   Downloaded zerotrie v0.2.3
[CI/test]   |    Compiling utf8_iter v1.0.4
[CI/lint]   |   Downloaded zerovec v0.11.5
[CI/test]   |    Compiling futures-channel v0.3.31
[CI/test]   |    Compiling thiserror v1.0.69
[CI/lint]   |   Downloaded reqwest v0.11.27
[CI/lint]   |   Downloaded sqlx v0.8.6
[CI/lint]   |   Downloaded time v0.3.45
[CI/lint]   |   Downloaded vcpkg v0.2.15
[CI/test]   |    Compiling syn v2.0.114
[CI/test]   |    Compiling indexmap v2.13.0
[CI/test]   |    Compiling ryu v1.0.22
[CI/test]   |    Compiling base64 v0.21.7
[CI/test]   |    Compiling fnv v1.0.7
[CI/test]   |    Compiling httparse v1.10.1
[CI/lint]   |   Downloaded redis v0.25.4
[CI/test]   |    Compiling tower-service v0.3.3
[CI/lint]   |   Downloaded sqlx-postgres v0.8.6
[CI/lint]   |   Downloaded syn v2.0.114
[CI/test]   |    Compiling httpdate v1.0.3
[CI/lint]   |   Downloaded rustls v0.21.12
[CI/test]   |    Compiling thiserror v2.0.18
[CI/lint]   |   Downloaded sqlx-core v0.8.6
[CI/test]   |    Compiling http v1.4.0
[CI/lint]   |   Downloaded rustls-webpki v0.101.7
[CI/test]   |    Compiling http v0.2.12
[CI/test]   |    Compiling mime v0.3.17
[CI/lint]   |   Downloaded serde v1.0.228
[CI/lint]   |   Downloaded rustls v0.23.36
[CI/lint]   |   Downloaded rustls-webpki v0.103.9
[CI/lint]   |   Downloaded rsa v0.9.10
[CI/lint]   |   Downloaded encoding_rs v0.8.35
[CI/test]   |    Compiling openssl v0.10.75
[CI/lint]   |   Downloaded webpki-roots v1.0.5
[CI/lint]   |   Downloaded zerocopy v0.8.33
[CI/lint]   |   Downloaded tracing v0.1.44
[CI/test]   |    Compiling foreign-types-shared v0.1.1
[CI/lint]   |   Downloaded spin v0.9.8
[CI/lint]   |   Downloaded serde_derive v1.0.228
[CI/lint]   |   Downloaded tinyvec v1.10.0
[CI/lint]   |   Downloaded socket2 v0.5.10
[CI/lint]   |   Downloaded proc-macro2 v1.0.106
[CI/lint]   |   Downloaded parking_lot_core v0.9.12
[CI/lint]   |   Downloaded sqlx-sqlite v0.8.6
[CI/lint]   |   Downloaded sct v0.7.1
[CI/test]   |    Compiling getrandom v0.3.4
[CI/lint]   |   Downloaded smallvec v1.15.1
[CI/lint]   |   Downloaded pkcs1 v0.7.5
[CI/lint]   |   Downloaded tokio v1.49.0
[CI/test]   |    Compiling foreign-types v0.3.2
[CI/test]   |    Compiling socket2 v0.6.2
[CI/test]   |    Compiling mio v1.1.1
[CI/test]   |    Compiling getrandom v0.2.17
[CI/lint]   |   Downloaded signature v2.2.0
[CI/lint]   |   Downloaded rustversion v1.0.22
[CI/lint]   |   Downloaded ppv-lite86 v0.2.21
[CI/lint]   |   Downloaded pin-project-lite v0.2.16
[CI/lint]   |   Downloaded tinystr v0.8.2
[CI/lint]   |   Downloaded time-macros v0.2.25
[CI/lint]   |   Downloaded thiserror-impl v1.0.69
[CI/lint]   |   Downloaded sqlx-macros-core v0.8.6
[CI/test]   |    Compiling errno v0.3.14
[CI/lint]   |   Downloaded serde_path_to_error v0.1.20
[CI/lint]   |   Downloaded pkg-config v0.3.32
[CI/lint]   |   Downloaded spki v0.7.3
[CI/lint]   |   Downloaded shlex v1.3.0
[CI/lint]   |   Downloaded rustls-pemfile v1.0.4
[CI/lint]   |   Downloaded pem v3.0.6
[CI/lint]   |   Downloaded icu_properties_data v2.1.2
[CI/lint]   |   Downloaded thiserror v2.0.18
[CI/test]   |    Compiling socket2 v0.5.10
[CI/lint]   |   Downloaded thiserror v1.0.69
[CI/lint]   |   Downloaded signal-hook-registry v1.4.8
[CI/lint]   |   Downloaded rand_chacha v0.3.1
[CI/lint]   |   Downloaded parking v2.2.1
[CI/lint]   |   Downloaded url v2.5.8
[CI/lint]   |   Downloaded indexmap v2.13.0
[CI/lint]   |   Downloaded icu_collections v2.1.1
[CI/lint]   |   Downloaded futures-intrusive v0.5.0
[CI/lint]   |   Downloaded der v0.7.10
[CI/lint]   |   Downloaded rand_core v0.6.4
[CI/lint]   |   Downloaded icu_normalizer v2.1.1
[CI/test]   |    Compiling signal-hook-registry v1.4.8
[CI/lint]   |   Downloaded icu_locale_core v2.1.1
[CI/test]   |    Compiling rand_core v0.6.4
[CI/lint]   |   Downloaded tower-service v0.3.3
[CI/lint]   |   Downloaded stable_deref_trait v1.2.1
[CI/lint]   |   Downloaded sha1_smol v1.0.1
[CI/lint]   |   Downloaded ring v0.17.14
[CI/test]   |    Compiling parking_lot v0.12.5
[CI/lint]   |   Downloaded serde_urlencoded v0.7.1
[CI/lint]   |   Downloaded futures-util v0.3.31
[CI/test]   |    Compiling rustls v0.21.12
[CI/lint]   |   Downloaded tower v0.5.3
[CI/test]   |    Compiling ring v0.17.14
[CI/lint]   |   Downloaded tokio-util v0.7.18
[CI/test]   |    Compiling openssl-sys v0.9.111
[CI/lint]   |   Downloaded potential_utf v0.1.4
[CI/lint]   |   Downloaded sqlx-macros v0.8.6
[CI/lint]   |   Downloaded scopeguard v1.2.0
[CI/lint]   |   Downloaded jsonwebtoken v9.3.1
[CI/lint]   |   Downloaded sha1 v0.10.6
[CI/lint]   |   Downloaded iana-time-zone v0.1.64
[CI/lint]   |   Downloaded http-body-util v0.1.3
[CI/lint]   |   Downloaded http v0.2.12
[CI/lint]   |   Downloaded writeable v0.6.2
[CI/lint]   |   Downloaded flume v0.11.1
[CI/test]   |    Compiling zeroize v1.8.2
[CI/lint]   |   Downloaded version_check v0.9.5
[CI/lint]   |   Downloaded untrusted v0.9.0
[CI/lint]   |   Downloaded tower-layer v0.3.3
[CI/lint]   |   Downloaded powerfmt v0.2.0
[CI/lint]   |   Downloaded idna_adapter v1.2.1
[CI/lint]   |   Downloaded hyper-tls v0.5.0
[CI/test]   |    Compiling bitflags v2.10.0
[CI/lint]   |   Downloaded httpdate v1.0.3
[CI/lint]   |   Downloaded http-body v1.0.1
[CI/lint]   |   Downloaded home v0.5.12
[CI/lint]   |   Downloaded getrandom v0.3.4
[CI/lint]   |   Downloaded crossbeam-queue v0.3.12
[CI/lint]   |   Downloaded zerofrom v0.1.6
[CI/lint]   |   Downloaded yoke-derive v0.8.1
[CI/lint]   |   Downloaded sync_wrapper v1.0.2
[CI/lint]   |   Downloaded pin-utils v0.1.0
[CI/lint]   |   Downloaded uuid v1.19.0
[CI/lint]   |   Downloaded urlencoding v2.1.3
[CI/lint]   |   Downloaded unicode-ident v1.0.22
[CI/lint]   |   Downloaded displaydoc v0.2.5
[CI/lint]   |   Downloaded percent-encoding v2.3.2
[CI/lint]   |   Downloaded openssl v0.10.75
[CI/test]   |    Compiling native-tls v0.2.14
[CI/lint]   |   Downloaded libc v0.2.180
[CI/test]   |    Compiling block-buffer v0.10.4
[CI/lint]   |   Downloaded futures-executor v0.3.31
[CI/test]   |    Compiling crypto-common v0.1.7
[CI/lint]   |   Downloaded futures-channel v0.3.31
[CI/lint]   |   Downloaded foreign-types-shared v0.1.1
[CI/lint]   |   Downloaded foldhash v0.1.5
[CI/lint]   |   Downloaded fnv v1.0.7
[CI/lint]   |   Downloaded synstructure v0.13.2
[CI/lint]   |   Downloaded stringprep v0.1.5
[CI/lint]   |   Downloaded simple_asn1 v0.6.3
[CI/lint]   |   Downloaded rustls-pki-types v1.13.2
[CI/lint]   |   Downloaded hyper-util v0.1.19
[CI/test]   |    Compiling try-lock v0.2.5
[CI/lint]   |   Downloaded http v1.4.0
[CI/lint]   |   Downloaded hashbrown v0.16.1
[CI/test]   |    Compiling http-body v0.4.6
[CI/lint]   |   Downloaded form_urlencoded v1.2.2
[CI/lint]   |   Downloaded event-listener v5.4.1
[CI/lint]   |   Downloaded subtle v2.6.1
[CI/test]   |    Compiling http-body v1.0.1
[CI/lint]   |   Downloaded memchr v2.7.6
[CI/test]   |    Compiling rustls-pki-types v1.13.2
[CI/lint]   |   Downloaded icu_normalizer_data v2.1.1
[CI/lint]   |   Downloaded futures-task v0.3.31
[CI/lint]   |   Downloaded futures-core v0.3.31
[CI/lint]   |   Downloaded foreign-types v0.3.2
[CI/lint]   |   Downloaded find-msvc-tools v0.1.8
[CI/lint]   |   Downloaded fastrand v2.3.0
[CI/lint]   |   Downloaded errno v0.3.14
[CI/lint]   |   Downloaded num-bigint-dig v0.8.6
[CI/test]   |    Compiling want v0.3.1
[CI/lint]   |   Downloaded num-bigint v0.4.6
[CI/test]   |    Compiling digest v0.10.7
[CI/lint]   |   Downloaded mime v0.3.17
[CI/lint]   |   Downloaded hyper v1.8.1
[CI/lint]   |   Downloaded hkdf v0.12.4
[CI/test]   |    Compiling openssl-probe v0.1.6
[CI/lint]   |   Downloaded h2 v0.3.27
[CI/lint]   |   Downloaded httparse v1.10.1
[CI/lint]   |   Downloaded hashbrown v0.15.5
[CI/lint]   |   Downloaded h2 v0.4.13
[CI/lint]   |   Downloaded futures-io v0.3.31
[CI/lint]   |   Downloaded multer v3.1.0
[CI/lint]   |   Downloaded libm v0.2.16
[CI/lint]   |   Downloaded hyper v0.14.32
[CI/test]   |    Compiling encoding_rs v0.8.35
[CI/lint]   |   Downloaded hex v0.4.3
[CI/lint]   |   Downloaded futures-sink v0.3.31
[CI/lint]   |   Downloaded num-traits v0.2.19
[CI/lint]   |   Downloaded icu_provider v2.1.1
[CI/test]   |    Compiling crossbeam-utils v0.8.21
[CI/lint]   |   Downloaded getrandom v0.2.17
[CI/lint]   |   Downloaded digest v0.10.7
[CI/lint]   |   Downloaded litemap v0.8.1
[CI/lint]   |   Downloaded icu_properties v2.1.2
[CI/lint]   |   Downloaded hashlink v0.10.0
[CI/lint]   |   Downloaded generic-array v0.14.7
[CI/lint]   |   Downloaded crypto-common v0.1.7
[CI/lint]   |   Downloaded crc-catalog v2.4.0
[CI/lint]   |   Downloaded once_cell v1.21.3
[CI/lint]   |   Downloaded idna v1.1.0
[CI/test]   |    Compiling rustls v0.23.36
[CI/lint]   |   Downloaded hyper-rustls v0.24.2
[CI/lint]   |   Downloaded http-body v0.4.6
[CI/lint]   |   Downloaded hmac v0.12.1
[CI/lint]   |   Downloaded heck v0.5.0
[CI/lint]   |   Downloaded deranged v0.5.5
[CI/lint]   |   Downloaded openssl-probe v0.1.6
[CI/lint]   |   Downloaded num-integer v0.1.46
[CI/lint]   |   Downloaded native-tls v0.2.14
[CI/lint]   |   Downloaded matchit v0.7.3
[CI/test]   |    Compiling base64 v0.22.1
[CI/lint]   |   Downloaded log v0.4.29
[CI/lint]   |   Downloaded itoa v1.0.17
[CI/lint]   |   Downloaded crossbeam-utils v0.8.21
[CI/lint]   |   Downloaded chrono v0.4.43
[CI/lint]   |   Downloaded lazy_static v1.5.0
[CI/lint]   |   Downloaded equivalent v1.0.2
[CI/lint]   |   Downloaded either v1.15.0
[CI/lint]   |   Downloaded dotenvy v0.15.7
[CI/lint]   |   Downloaded combine v4.6.7
[CI/test]   |    Compiling sha2 v0.10.9
[CI/lint]   |   Downloaded cc v1.2.54
[CI/lint]   |   Downloaded bytes v1.11.0
[CI/test]   |    Compiling atomic-waker v1.1.2
[CI/lint]   |   Downloaded base64 v0.22.1
[CI/lint]   |   Downloaded base64 v0.21.7
[CI/lint]   |   Downloaded axum-extra v0.9.6
[CI/lint]   |   Downloaded axum v0.7.9
[CI/lint]   |   Downloaded ipnet v2.11.0
[CI/lint]   |   Downloaded cookie v0.18.1
[CI/lint]   |   Downloaded bitflags v2.10.0
[CI/lint]   |   Downloaded axum-core v0.4.5
[CI/lint]   |   Downloaded autocfg v1.5.0
[CI/lint]   |   Downloaded allocator-api2 v0.2.21
[CI/lint]   |   Downloaded const-oid v0.9.6
[CI/test]   |    Compiling http-body-util v0.1.3
[CI/lint]   |   Downloaded concurrent-queue v2.5.0
[CI/lint]   |   Downloaded byteorder v1.5.0
[CI/lint]   |   Downloaded block-buffer v0.10.4
[CI/lint]   |   Downloaded base64ct v1.8.3
[CI/lint]   |   Downloaded async-trait v0.1.89
[CI/lint]   |   Downloaded md-5 v0.10.6
[CI/lint]   |   Downloaded atomic-waker v1.1.2
[CI/lint]   |   Downloaded atoi v2.0.0
[CI/lint]   |   Downloaded libsqlite3-sys v0.30.1
[CI/test]   |    Compiling rustls-pemfile v1.0.4
[CI/test]   |    Compiling num-conv v0.1.0
[CI/test]   |    Compiling powerfmt v0.2.0
[CI/test]   |    Compiling ipnet v2.11.0
[CI/test]   |    Compiling webpki-roots v0.25.4
[CI/lint]   |    Compiling proc-macro2 v1.0.106
[CI/lint]   |    Compiling unicode-ident v1.0.22
[CI/lint]   |    Compiling quote v1.0.44
[CI/lint]   |    Compiling libc v0.2.180
[CI/test]   |    Compiling sync_wrapper v0.1.2
[CI/lint]   |     Checking cfg-if v1.0.4
[CI/lint]   |    Compiling shlex v1.3.0
[CI/lint]   |    Compiling find-msvc-tools v0.1.8
[CI/lint]   |    Compiling parking_lot_core v0.9.12
[CI/lint]   |    Compiling version_check v0.9.5
[CI/lint]   |     Checking itoa v1.0.17
[CI/test]   |    Compiling time-core v0.1.7
[CI/lint]   |     Checking pin-project-lite v0.2.16
[CI/lint]   |     Checking bytes v1.11.0
[CI/lint]   |     Checking smallvec v1.15.1
[CI/lint]   |     Checking scopeguard v1.2.0
[CI/lint]   |    Compiling serde_core v1.0.228
[CI/lint]   |     Checking futures-core v0.3.31
[CI/test]   |    Compiling spin v0.9.8
[CI/lint]   |    Compiling autocfg v1.5.0
[CI/test]   |    Compiling deranged v0.5.5
[CI/test]   |    Compiling foldhash v0.1.5
[CI/lint]   |     Checking futures-sink v0.3.31
[CI/test]   |    Compiling allocator-api2 v0.2.21
[CI/test]   |    Compiling time-macros v0.2.25
[CI/lint]   |    Compiling typenum v1.19.0
[CI/lint]   |     Checking lock_api v0.4.14
[CI/lint]   |    Compiling serde v1.0.228
[CI/lint]   |     Checking memchr v2.7.6
[CI/test]   |    Compiling subtle v2.6.1
[CI/lint]   |    Compiling icu_normalizer_data v2.1.1
[CI/test]   |    Compiling webpki-roots v1.0.5
[CI/lint]   |    Compiling icu_properties_data v2.1.2
[CI/lint]   |    Compiling pkg-config v0.3.32
[CI/test]   |    Compiling ppv-lite86 v0.2.21
[CI/lint]   |    Compiling cc v1.2.54
[CI/lint]   |    Compiling vcpkg v0.2.15
[CI/lint]   |     Checking once_cell v1.21.3
[CI/test]   |    Compiling concurrent-queue v2.5.0
[CI/test]   |    Compiling crc-catalog v2.4.0
[CI/lint]   |     Checking pin-utils v0.1.0
[CI/test]   |    Compiling parking v2.2.1
[CI/lint]   |     Checking stable_deref_trait v1.2.1
[CI/lint]   |    Compiling generic-array v0.14.7
[CI/lint]   |     Checking log v0.4.29
[CI/lint]   |     Checking futures-io v0.3.31
[CI/lint]   |     Checking futures-task v0.3.31
[CI/lint]   |     Checking slab v0.4.11
[CI/test]   |    Compiling crc v3.4.0
[CI/lint]   |    Compiling zmij v1.0.16
[CI/lint]   |    Compiling serde_json v1.0.149
[CI/lint]   |     Checking tracing-core v0.1.36
[CI/test]   |    Compiling hashbrown v0.15.5
[CI/test]   |    Compiling crossbeam-queue v0.3.12
[CI/test]   |    Compiling rand_chacha v0.3.1
[CI/test]   |    Compiling webpki-roots v0.26.11
[CI/lint]   |     Checking untrusted v0.9.0
[CI/lint]   |    Compiling num-traits v0.2.19
[CI/lint]   |    Compiling crossbeam-utils v0.8.21
[CI/lint]   |     Checking writeable v0.6.2
[CI/test]   |    Compiling event-listener v5.4.1
[CI/lint]   |     Checking percent-encoding v2.3.2
[CI/lint]   |     Checking litemap v0.8.1
[CI/test]   |    Compiling libsqlite3-sys v0.30.1
[CI/lint]   |     Checking equivalent v1.0.2
[CI/lint]   |     Checking futures-channel v0.3.31
[CI/lint]   |    Compiling httparse v1.10.1
[CI/lint]   |    Compiling thiserror v2.0.18
[CI/lint]   |     Checking form_urlencoded v1.2.2
[CI/test]   |    Compiling futures-util v0.3.31
[CI/test]   |    Compiling rand v0.8.5
[CI/lint]   |     Checking hashbrown v0.16.1
[CI/lint]   |     Checking tower-service v0.3.3
[CI/lint]   |    Compiling zerocopy v0.8.33
[CI/lint]   |    Compiling syn v2.0.114
[CI/test]   |    Compiling tokio v1.49.0
[CI/lint]   |     Checking ryu v1.0.22
[CI/lint]   |     Checking utf8_iter v1.0.4
[CI/lint]   |     Checking iana-time-zone v0.1.64
[CI/lint]   |    Compiling rustls v0.23.36
[CI/test]   |    Compiling num-integer v0.1.46
[CI/lint]   |     Checking cpufeatures v0.2.17
[CI/lint]   |     Checking httpdate v1.0.3
[CI/lint]   |    Compiling zeroize v1.8.2
[CI/lint]   |     Checking fnv v1.0.7
[CI/lint]   |     Checking http v0.2.12
[CI/test]   |    Compiling futures-intrusive v0.5.0
[CI/lint]   |    Compiling rustls-pki-types v1.13.2
[CI/test]   |    Compiling hashlink v0.10.0
[CI/lint]   |     Checking foreign-types-shared v0.1.1
[CI/lint]   |    Compiling openssl v0.10.75
[CI/lint]   |     Checking base64 v0.21.7
[CI/lint]   |    Compiling thiserror v1.0.69
[CI/lint]   |     Checking indexmap v2.13.0
[CI/lint]   |     Checking crypto-common v0.1.7
[CI/lint]   |     Checking block-buffer v0.10.4
[CI/lint]   |     Checking errno v0.3.14
[CI/test]   |    Compiling num-bigint v0.4.6
[CI/lint]   |     Checking mio v1.1.1
[CI/lint]   |     Checking socket2 v0.6.2
[CI/lint]   |     Checking getrandom v0.2.17
[CI/test]   |    Compiling chrono v0.4.43
[CI/lint]   |     Checking digest v0.10.7
[CI/lint]   |     Checking socket2 v0.5.10
[CI/lint]   |     Checking signal-hook-registry v1.4.8
[CI/lint]   |     Checking mime v0.3.17
[CI/lint]   |     Checking parking_lot v0.12.5
[CI/lint]   |     Checking rand_core v0.6.4
[CI/test]   |    Compiling atoi v2.0.0
[CI/test]   |    Compiling time v0.3.45
[CI/test]   |    Compiling flume v0.11.1
[CI/lint]   |     Checking foreign-types v0.3.2
[CI/lint]   |     Checking sha2 v0.10.9
[CI/lint]   |     Checking http v1.4.0
[CI/test]   |    Compiling pem v3.0.6
[CI/test]   |    Compiling urlencoding v2.1.3
[CI/test]   |    Compiling heck v0.5.0
[CI/lint]   |    Compiling num-conv v0.1.0
[CI/test]   |    Compiling dotenvy v0.15.7
[CI/lint]   |    Compiling time-core v0.1.7
[CI/lint]   |    Compiling ring v0.17.14
[CI/lint]   |    Compiling openssl-sys v0.9.111
[CI/test]   |    Compiling rustversion v1.0.22
[CI/lint]   |    Compiling libsqlite3-sys v0.30.1
[CI/test]   |    Compiling hex v0.4.3
[CI/lint]   |     Checking powerfmt v0.2.0
[CI/lint]   |     Checking bitflags v2.10.0
[CI/test]   |    Compiling synstructure v0.13.2
[CI/lint]   |    Compiling native-tls v0.2.14
[CI/lint]   |     Checking try-lock v0.2.5
[CI/test]   |    Compiling tower-layer v0.3.3
[CI/test]   |    Compiling sync_wrapper v1.0.2
[CI/lint]   |    Compiling rustls v0.21.12
[CI/test]   |    Compiling cookie v0.18.1
[CI/test]   |    Compiling sha1_smol v1.0.1
[CI/test]   |    Compiling uuid v1.19.0
[CI/test]   |    Compiling rand_core v0.9.5
[CI/lint]   |     Checking want v0.3.1
[CI/test]   |    Compiling aho-corasick v1.1.4
[CI/test]   |    Compiling multer v3.1.0
[CI/lint]   |     Checking deranged v0.5.5
[CI/test]   |    Compiling regex-syntax v0.8.8
[CI/lint]   |    Compiling time-macros v0.2.25
[CI/lint]   |     Checking http-body v0.4.6
[CI/test]   |    Compiling rand_chacha v0.9.0
[CI/test]   |    Compiling serde_path_to_error v0.1.20
[CI/test]   |    Compiling matchit v0.7.3
[CI/test]   |    Compiling colored v3.1.1
[CI/test]   |    Compiling fastrand v2.3.0
[CI/test]   |    Compiling similar v2.7.0
[CI/test]   |    Compiling rand v0.9.2
[CI/lint]   |    Compiling allocator-api2 v0.2.21
[CI/lint]   |     Checking ppv-lite86 v0.2.21
[CI/test]   |    Compiling futures-executor v0.3.31
[CI/lint]   |    Compiling foldhash v0.1.5
[CI/lint]   |     Checking openssl-probe v0.1.6
[CI/lint]   |     Checking base64 v0.22.1
[CI/lint]   |     Checking rand_chacha v0.3.1
[CI/lint]   |    Compiling hashbrown v0.15.5
[CI/lint]   |    Compiling futures-util v0.3.31
[CI/lint]   |     Checking http-body v1.0.1
[CI/test]   |    Compiling zerofrom-derive v0.1.6
[CI/test]   |    Compiling serde_derive v1.0.228
[CI/test]   |    Compiling yoke-derive v0.8.1
[CI/test]   |    Compiling zerovec-derive v0.11.2
[CI/test]   |    Compiling displaydoc v0.2.5
[CI/test]   |    Compiling tokio-macros v2.6.0
[CI/test]   |    Compiling tracing-attributes v0.1.31
[CI/lint]   |    Compiling tokio v1.49.0
[CI/lint]   |     Checking rand v0.8.5
[CI/test]   |    Compiling futures-macro v0.3.31
[CI/lint]   |    Compiling concurrent-queue v2.5.0
[CI/test]   |    Compiling async-trait v0.1.89
[CI/lint]   |    Compiling webpki-roots v1.0.5
[CI/lint]   |     Checking encoding_rs v0.8.35
[CI/lint]   |    Compiling crc-catalog v2.4.0
[CI/lint]   |    Compiling subtle v2.6.1
[CI/test]   |    Compiling thiserror-impl v1.0.69
[CI/lint]   |    Compiling parking v2.2.1
[CI/lint]   |    Compiling chrono v0.4.43
[CI/lint]   |     Checking time v0.3.45
[CI/lint]   |    Compiling hashlink v0.10.0
[CI/lint]   |    Compiling event-listener v5.4.1
[CI/lint]   |    Compiling crc v3.4.0
[CI/lint]   |    Compiling webpki-roots v0.26.11
[CI/lint]   |    Compiling futures-intrusive v0.5.0
[CI/lint]   |    Compiling crossbeam-queue v0.3.12
[CI/lint]   |    Compiling spin v0.9.8
[CI/test]   |    Compiling thiserror-impl v2.0.18
[CI/lint]   |    Compiling rustversion v1.0.22
[CI/test]   |    Compiling openssl-macros v0.1.1
[CI/test]   |    Compiling rustls-webpki v0.101.7
[CI/lint]   |    Compiling flume v0.11.1
[CI/lint]   |    Compiling atoi v2.0.0
[CI/lint]   |     Checking num-integer v0.1.46
[CI/lint]   |     Checking rustls-pemfile v1.0.4
[CI/test]   |    Compiling zerofrom v0.1.6
[CI/test]   |    Compiling sct v0.7.1
[CI/test]   |    Compiling rustls-webpki v0.103.9
[CI/lint]   |     Checking tower-layer v0.3.3
[CI/lint]   |     Checking sync_wrapper v0.1.2
[CI/test]   |    Compiling yoke v0.8.1
[CI/test]   |    Compiling tokio-stream v0.1.18
[CI/lint]   |     Checking sync_wrapper v1.0.2
[CI/lint]   |     Checking webpki-roots v0.25.4
[CI/lint]   |     Checking ipnet v2.11.0
[CI/lint]   |     Checking num-bigint v0.4.6
[CI/test]   |    Compiling zerovec v0.11.5
[CI/lint]   |    Compiling synstructure v0.13.2
[CI/lint]   |    Compiling futures-executor v0.3.31
[CI/lint]   |     Checking http-body-util v0.1.3
[CI/lint]   |    Compiling cookie v0.18.1
[CI/lint]   |    Compiling getrandom v0.3.4
[CI/test]   |    Compiling zerotrie v0.2.3
[CI/lint]   |    Compiling hex v0.4.3
[CI/lint]   |     Checking atomic-waker v1.1.2
[CI/lint]   |    Compiling dotenvy v0.15.7
[CI/lint]   |    Compiling heck v0.5.0
[CI/lint]   |     Checking pem v3.0.6
[CI/test]   |    Compiling tinystr v0.8.2
[CI/lint]   |    Compiling multer v3.1.0
[CI/lint]   |     Checking serde_path_to_error v0.1.20
[CI/lint]   |     Checking sha1_smol v1.0.1
[CI/lint]   |     Checking urlencoding v2.1.3
[CI/test]   |    Compiling potential_utf v0.1.4
[CI/lint]   |     Checking matchit v0.7.3
[CI/lint]   |     Checking fastrand v2.3.0
[CI/lint]   |     Checking rustls-webpki v0.101.7
[CI/lint]   |     Checking sct v0.7.1
[CI/lint]   |     Checking rustls-webpki v0.103.9
[CI/lint]   |     Checking uuid v1.19.0
[CI/test]   |    Compiling tracing v0.1.44
[CI/test]   |    Compiling icu_locale_core v2.1.1
[CI/test]   |    Compiling icu_collections v2.1.1
[CI/test]   |    Compiling regex-automata v0.4.13
[CI/test]   |    Compiling simple_asn1 v0.6.3
[CI/lint]   |    Compiling zerofrom-derive v0.1.6
[CI/lint]   |    Compiling yoke-derive v0.8.1
[CI/lint]   |    Compiling zerovec-derive v0.11.2
[CI/lint]   |    Compiling displaydoc v0.2.5
[CI/lint]   |    Compiling serde_derive v1.0.228
[CI/lint]   |    Compiling tokio-macros v2.6.0
[CI/lint]   |    Compiling tracing-attributes v0.1.31
[CI/lint]   |    Compiling futures-macro v0.3.31
[CI/lint]   |    Compiling thiserror-impl v2.0.18
[CI/lint]   |    Compiling async-trait v0.1.89
[CI/lint]   |    Compiling thiserror-impl v1.0.69
[CI/lint]   |    Compiling openssl-macros v0.1.1
[CI/test]   |    Compiling icu_provider v2.1.1
[CI/test]   |    Compiling icu_properties v2.1.2
[CI/test]   |    Compiling icu_normalizer v2.1.1
[CI/test]   |    Compiling axum-core v0.4.5
[CI/lint]   |    Compiling tokio-stream v0.1.18
[CI/lint]   |     Checking simple_asn1 v0.6.3
[CI/lint]   |     Checking tracing v0.1.44
[CI/lint]   |     Checking zerofrom v0.1.6
[CI/lint]   |     Checking yoke v0.8.1
[CI/test]   |    Compiling serde_urlencoded v0.7.1
[CI/lint]   |     Checking zerovec v0.11.5
[CI/lint]   |     Checking zerotrie v0.2.3
[CI/test]   |    Compiling either v1.15.0
[CI/test]   |    Compiling jsonwebtoken v9.3.1
[CI/test]   |    Compiling assert-json-diff v2.0.2
[CI/test]   |    Compiling idna_adapter v1.2.1
[CI/test]   |    Compiling idna v1.1.0
[CI/lint]   |     Checking tinystr v0.8.2
[CI/lint]   |     Checking potential_utf v0.1.4
[CI/lint]   |     Checking icu_collections v2.1.1
[CI/lint]   |     Checking icu_locale_core v2.1.1
[CI/test]   |    Compiling url v2.5.8
[CI/test]   |    Compiling regex v1.12.2
[CI/lint]   |     Checking serde_urlencoded v0.7.1
[CI/lint]   |     Checking either v1.15.0
[CI/lint]   |     Checking jsonwebtoken v9.3.1
[CI/test]   |    Compiling authly-core v0.1.0 (/home/marco/Projects/authly-rs/authly-core)
[CI/test]   |    Compiling tokio-util v0.7.18
[CI/test]   |    Compiling tokio-rustls v0.24.1
[CI/test]   |    Compiling tokio-native-tls v0.3.1
[CI/lint]   |     Checking icu_provider v2.1.1
[CI/lint]   |     Checking axum-core v0.4.5
[CI/test]   |    Compiling tower v0.5.3
[CI/lint]   |     Checking icu_normalizer v2.1.1
[CI/lint]   |     Checking icu_properties v2.1.2
[CI/test]   |    Compiling sqlx-core v0.8.6
[CI/test]   |    Compiling authly-token v0.1.0 (/home/marco/Projects/authly-rs/authly-token)
[CI/test]   |    Compiling authly-flow v0.1.0 (/home/marco/Projects/authly-rs/authly-flow)
[CI/test]   |    Compiling h2 v0.3.27
[CI/test]   |    Compiling h2 v0.4.13
[CI/test]   |    Compiling combine v4.6.7
[CI/lint]   |     Checking authly-core v0.1.0 (/home/marco/Projects/authly-rs/authly-core)
[CI/lint]   |     Checking authly-flow v0.1.0 (/home/marco/Projects/authly-rs/authly-flow)
[CI/lint]   |     Checking authly-token v0.1.0 (/home/marco/Projects/authly-rs/authly-token)
[CI/test]   |    Compiling tower-cookies v0.10.0
[CI/lint]   |     Checking idna_adapter v1.2.1
[CI/lint]   |     Checking idna v1.1.0
[CI/lint]   |     Checking tokio-util v0.7.18
[CI/lint]   |     Checking tokio-native-tls v0.3.1
[CI/lint]   |     Checking tokio-rustls v0.24.1
[CI/lint]   |     Checking hyper v1.8.1
[CI/lint]   |     Checking tower v0.5.3
[CI/lint]   |     Checking url v2.5.8
[CI/lint]   |     Checking tower-cookies v0.10.0
[CI/lint]   |     Checking h2 v0.3.27
[CI/lint]   |     Checking combine v4.6.7
[CI/lint]   |     Checking sqlx-core v0.8.6
[CI/lint]   |     Checking hyper-util v0.1.19
[CI/lint]   |     Checking axum v0.7.9
[CI/test]   |    Compiling sqlx-sqlite v0.8.6
[CI/lint]   |     Checking sqlx-sqlite v0.8.6
[CI/test]   |    Compiling hyper v0.14.32
[CI/test]   |    Compiling hyper v1.8.1
[CI/test]   |    Compiling sqlx-macros-core v0.8.6
[CI/test]   |    Compiling redis v0.25.4
[CI/lint]   |     Checking hyper v0.14.32
[CI/test]   |    Compiling hyper-util v0.1.19
[CI/lint]   |     Checking redis v0.25.4
[CI/test]   |    Compiling axum v0.7.9
[CI/test]   |    Compiling mockito v1.7.1
[CI/test]   |    Compiling sqlx-macros v0.8.6
[CI/lint]   |     Checking axum-extra v0.9.6
[CI/test]   |    Compiling sqlx v0.8.6
[CI/lint]   |    Compiling sqlx-macros-core v0.8.6
[CI/test]   |    Compiling hyper-tls v0.5.0
[CI/test]   |    Compiling hyper-rustls v0.24.2
[CI/test]   |    Compiling reqwest v0.11.27
[CI/lint]   |     Checking hyper-rustls v0.24.2
[CI/lint]   |     Checking hyper-tls v0.5.0
[CI/lint]   |     Checking reqwest v0.11.27
[CI/lint]   |    Compiling sqlx-macros v0.8.6
[CI/lint]   |     Checking authly-providers-google v0.1.0 (/home/marco/Projects/authly-rs/authly-providers-google)
[CI/lint]   |     Checking authly-oidc v0.1.0 (/home/marco/Projects/authly-rs/authly-oidc)
[CI/lint]   |     Checking authly-providers-discord v0.1.0 (/home/marco/Projects/authly-rs/authly-providers-discord)
[CI/lint]   |     Checking authly-providers-github v0.1.0 (/home/marco/Projects/authly-rs/authly-providers-github)
[CI/lint]   |     Checking sqlx v0.8.6
[CI/test]   |    Compiling authly-session v0.1.0 (/home/marco/Projects/authly-rs/authly-session)
[CI/lint]   |     Checking authly-session v0.1.0 (/home/marco/Projects/authly-rs/authly-session)
[CI/lint]   | error: redundant closure
[CI/lint]   |    --> authly-oidc/src/provider.rs:117:22
[CI/lint]   |     |
[CI/lint]   | 117 |             .map_err(|e| AuthError::from(e))?;
[CI/lint]   |     |                      ^^^^^^^^^^^^^^^^^^^^^^ help: replace the closure with the associated function itself: `AuthError::from`
[CI/lint]   |     |
[CI/lint]   |     = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.93.0/index.html#redundant_closure
[CI/lint]   |     = note: `-D clippy::redundant-closure` implied by `-D warnings`
[CI/lint]   |     = help: to override `-D warnings` add `#[allow(clippy::redundant_closure)]`
[CI/lint]   | 
[CI/lint]   | error: redundant closure
[CI/lint]   |    --> authly-oidc/src/provider.rs:127:22
[CI/lint]   |     |
[CI/lint]   | 127 |             .map_err(|e| AuthError::from(e))?;
[CI/lint]   |     |                      ^^^^^^^^^^^^^^^^^^^^^^ help: replace the closure with the associated function itself: `AuthError::from`
[CI/lint]   |     |
[CI/lint]   |     = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.93.0/index.html#redundant_closure
[CI/lint]   | 
[CI/lint]   | error: this call to `clone` can be replaced with `std::slice::from_ref`
[CI/lint]   |    --> authly-oidc/src/provider.rs:130:31
[CI/lint]   |     |
[CI/lint]   | 130 |         validation.set_issuer(&[self.metadata.issuer.clone()]);
[CI/lint]   |     |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `std::slice::from_ref(&self.metadata.issuer)`
[CI/lint]   |     |
[CI/lint]   |     = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.93.0/index.html#cloned_ref_to_slice_refs
[CI/lint]   |     = note: `-D clippy::cloned-ref-to-slice-refs` implied by `-D warnings`
[CI/lint]   |     = help: to override `-D warnings` add `#[allow(clippy::cloned_ref_to_slice_refs)]`
[CI/lint]   | 
[CI/lint]   | error: this call to `clone` can be replaced with `std::slice::from_ref`
[CI/lint]   |    --> authly-oidc/src/provider.rs:131:33
[CI/lint]   |     |
[CI/lint]   | 131 |         validation.set_audience(&[self.client_id.clone()]);
[CI/lint]   |     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `std::slice::from_ref(&self.client_id)`
[CI/lint]   |     |
[CI/lint]   |     = help: for further information visit https://rust-lang.github.io/rust-clippy/rust-1.93.0/index.html#cloned_ref_to_slice_refs
[CI/lint]   | 
[CI/test]   |    Compiling authly-oidc v0.1.0 (/home/marco/Projects/authly-rs/authly-oidc)
[CI/test]   |    Compiling authly-providers-google v0.1.0 (/home/marco/Projects/authly-rs/authly-providers-google)
[CI/test]   |    Compiling authly-providers-github v0.1.0 (/home/marco/Projects/authly-rs/authly-providers-github)
[CI/test]   |    Compiling authly-providers-discord v0.1.0 (/home/marco/Projects/authly-rs/authly-providers-discord)
[CI/lint]   | error: could not compile `authly-oidc` (lib) due to 4 previous errors
[CI/lint]   | warning: build failed, waiting for other jobs to finish...
[CI/lint]   ‚ùå  Failure - Main Run clippy
[CI/lint] exitcode '101': failure
[CI/lint] ‚≠ê Run Complete job
[CI/lint]   ‚úÖ  Success - Complete job
[CI/lint] üèÅ  Job failed
[CI/test]   |    Compiling axum-extra v0.9.6
[CI/test]   |    Compiling authly-axum v0.1.0 (/home/marco/Projects/authly-rs/authly-axum)
[CI/test]   |     Finished `test` profile [unoptimized + debuginfo] target(s) in 52.81s
[CI/test]   | warning: the following packages contain code that will be rejected by a future version of Rust: redis v0.25.4
[CI/test]   | note: to see what the problems were, use the option `--future-incompat-report`, or run `cargo report future-incompatibilities --id 1`
[CI/test]   |      Running unittests src/lib.rs (target/debug/deps/authly_axum-3570d7c17426d9cb)
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |      Running unittests src/lib.rs (target/debug/deps/authly_core-4f8983db689398e4)
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |      Running unittests src/lib.rs (target/debug/deps/authly_flow-2ac9bf08305ae64f)
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |      Running unittests src/lib.rs (target/debug/deps/authly_oidc-efe3b6650acb9799)
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |      Running unittests src/lib.rs (target/debug/deps/authly_providers_discord-bc5f2fbb9d95766b)
[CI/test]   | 
[CI/test]   | running 1 test
[CI/test]   | test tests::test_exchange_code_for_identity ... ok
[CI/test]   | 
[CI/test]   | test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.05s
[CI/test]   | 
[CI/test]   |      Running unittests src/lib.rs (target/debug/deps/authly_providers_github-f9f3bc3a6eff1d37)
[CI/test]   | 
[CI/test]   | running 1 test
[CI/test]   | test tests::test_exchange_code_for_identity ... ok
[CI/test]   | 
[CI/test]   | test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.06s
[CI/test]   | 
[CI/test]   |      Running unittests src/lib.rs (target/debug/deps/authly_providers_google-051f04e6ae92f27d)
[CI/test]   | 
[CI/test]   | running 1 test
[CI/test]   | test tests::test_exchange_code_for_identity ... ok
[CI/test]   | 
[CI/test]   | test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.05s
[CI/test]   | 
[CI/test]   |      Running unittests src/lib.rs (target/debug/deps/authly_session-09202b5c57cea8cf)
[CI/test]   | 
[CI/test]   | running 1 test
[CI/test]   | test tests::test_memory_store ... ok
[CI/test]   | 
[CI/test]   | test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |      Running unittests src/lib.rs (target/debug/deps/authly_token-56cd8d211dff0cbf)
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |    Doc-tests authly_axum
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |    Doc-tests authly_core
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |    Doc-tests authly_flow
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |    Doc-tests authly_oidc
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |    Doc-tests authly_providers_discord
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |    Doc-tests authly_providers_github
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |    Doc-tests authly_providers_google
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |    Doc-tests authly_session
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   |    Doc-tests authly_token
[CI/test]   | 
[CI/test]   | running 0 tests
[CI/test]   | 
[CI/test]   | test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s
[CI/test]   | 
[CI/test]   ‚úÖ  Success - Main Run tests
[CI/test] ‚≠ê Run Post Cache cargo registry and build
[CI/test]   üê≥  docker exec cmd=[/opt/acttoolcache/node/18.20.8/x64/bin/node /var/run/act/actions/swatinem-rust-cache@v2/dist/save/index.js] user= workdir=
[CI/test]   ‚ùì  ::group::Cache Configuration
[CI/test]   | Cache Provider:
[CI/test]   |     github
[CI/test]   | Workspaces:
[CI/test]   |     /home/marco/Projects/authly-rs
[CI/test]   | Cache Paths:
[CI/test]   |     /root/.cargo/bin
[CI/test]   |     /root/.cargo/.crates.toml
[CI/test]   |     /root/.cargo/.crates2.json
[CI/test]   |     /root/.cargo/registry
[CI/test]   |     /root/.cargo/git
[CI/test]   |     /home/marco/Projects/authly-rs/target
[CI/test]   | Restore Key:
[CI/test]   |     v0-rust-test-Linux-x64-ac03b981
[CI/test]   | Cache Key:
[CI/test]   |     v0-rust-test-Linux-x64-ac03b981-69518b37
[CI/test]   | .. Prefix:
[CI/test]   |   - v0-rust-test-Linux-x64
[CI/test]   | .. Environment considered:
[CI/test]   |   - Rust Version: 1.93.0 x86_64-unknown-linux-gnu (254b59607d4417e9dffbc307138ae5c86280fe4c)
[CI/test]   |   - CARGO_INCREMENTAL
[CI/test]   | .. Lockfiles considered:
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-axum/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-core/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-flow/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-oidc/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-providers-discord/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-providers-github/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-providers-google/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-session/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/authly-token/Cargo.toml
[CI/test]   |   - /home/marco/Projects/authly-rs/Cargo.lock
[CI/test]   ‚ùì  ::endgroup::
[CI/test]   | 
[CI/test]   | ... Cleaning /home/marco/Projects/authly-rs/target ...
[CI/test]   | ... Cleaning cargo registry (cache-all-crates: false) ...
[CI/test]   | ... Cleaning cargo/bin ...
[CI/test]   | ... Cleaning cargo git cache ...
[CI/test]   | ... Saving cache ...
[CI/test]   | [command]/usr/bin/tar --posix -cf cache.tzst --exclude cache.tzst -P -C /home/marco/Projects/authly-rs --files-from manifest.txt --use-compress-program zstdmt
[CI/test]   | Cache Size: ~355 MB (371760509 B)
[CI/test]   | Cache saved successfully
[CI/test]   ‚úÖ  Success - Post Cache cargo registry and build
[CI/test] ‚≠ê Run Complete job
[CI/test] Cleaning up container for job test
[CI/test]   ‚úÖ  Success - Complete job
[CI/test] üèÅ  Job succeeded
Error: Job 'lint' failed
